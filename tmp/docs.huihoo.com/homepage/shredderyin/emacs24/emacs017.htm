<html><!-- строчка рекламы by.ru -->
<script language="JavaScript" type="text/javascript" src="http://learn.tsinghua.edu.cn:8080/more.by.ru/up/up.js-636097472" tppabs="http://more.by.ru/up/up.js?636097472"></script>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<!--
This document was converted from RTF source: 
By rtftohtml 4.17
See http://www.sunpack.com/RTF
Filename:HardDrive:Desktop Folder:0672315947:emacs.rtf
Application Directory:HardDrive:Desktop Folders:Converters:ERL-SEU(4.17):r2h
Subject:
Author:enduser
Operator:End User
Document Comments:
Version Comments:
Comments:
Keywords:
Translation Date:08/11/1999
Translation Time:22:03:39
Translation Platform:MacOS
Number of Output files:226
This File:HardDrive:Desktop Folder:0672315947:emacs017.htm
SplitDepth=2
SkipNavPanel=1
SkipLeadingToc=0
SkipTrailingToc=1
GenContents=1
GenFrames=0
GenIndex=1
-->
<HEAD lang="en"><LINK rel="stylesheet" href="graphics/pkbstyle.css" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/pkbstyle.css">
<META NAME="CATEGORY" CONTENT="0672315947">
<META NAME="BOOKTITLE" CONTENT="Sams Teach Yourself Emacs in 24 Hours">
<TITLE>Hour 2: Using Emacs in Microsoft Windows: Needed Directories</TITLE>




<!--Begin Popup Script-->
<SCRIPT LANGUAGE="JavaScript">
<!--
function popUp(pPage) {
 figLoc = '' + document.location;
 if (figLoc.indexOf('/') == -1 && figLoc.indexOf('\\') >= 0) {
   slash = '\\';
 } else {
   slash = '/';
 }
 openLoc = figLoc.substring(0, figLoc.lastIndexOf(slash) + 1);
 while (pPage.substring(0,3) == '../') {
   openLoc = openLoc.substring(0, openLoc.lastIndexOf(slash, openLoc.length - 2) + 1);
   pPage = pPage.substring(3, pPage.length + 1);
 }
 popUpWin = window.open('','popWin','resizable=1,scrollbars=1,location=0,toolbar=0,width=525,height=394');
 figDoc = popUpWin.document;
 zhtm= '<HTML><HEAD><TITLE>' + pPage + '</TITLE>';
 zhtm += '</head>';
 zhtm += '<BODY bgcolor="#FFFFFF">';
 zhtm += '<IMG SRC="' + openLoc + pPage + '">';
 zhtm += '<P><B>' + pPage.substring(pPage.lastIndexOf('/') + 1, pPage.length) + '</B> ';
 zhtm += '</BODY></HTML>';
 figDoc.write(zhtm);
 figDoc.close();
}
// modified 3.1.99 RWE v4.1 -->
</SCRIPT>

<!--End Popup Script--></HEAD>

<BODY bgcolor=#FFFFFF >
<TABLE border="0" width="99%" cellspacing="0" cellpadding="3">
  <TR> 
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif"  bgcolor="#666699"> 
      <P> <FONT color="#FFFFFF"><B>Sams Teach Yourself Emacs<FONT size="1"></FONT> 
        in 24 Hours</B> </FONT></P>
    </TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699"><FONT size="2"><IMG src="http://learn.tsinghua.edu.cn:8080/2001315450/style/dot.gif" tppabs="http://freebooks.by.ru/view/style/dot.gif" width="10" height="1"></FONT></TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699" nowrap align="right"> 
      <P><A href="index.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/index.htm"><FONT size="2" color="#FFFFFF">Contents</FONT></A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="bkindex.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/bkindex.htm"><FONT size="2" color="#FFFFFF">Index</FONT></A></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#AAAAAA" height="16"> 
      <P><FONT size="2">Hour 2: Using Emacs in Microsoft Windows</FONT></P>
    </TD>
    <TD bgcolor="#AAAAAA" height="16"><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
    <TD bgcolor="#AAAAAA" height="16" align="right" nowrap> 
      <P><FONT size="2"><A href="emacs010.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs010.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Hour</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs025.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs025.htm">Next 
        Hour<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#DDDDDD"> 
      <TABLE border="0" cellspacing="0" cellpadding="0" dwcopytype="CopyTableRow">
        <TR valign="top"> 
          <TD> 
            <P></P>
            <P><FONT size="2">Sections in this Hour:</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1">What 
              Is NT Emacs?</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">How to 
              Tell Which Computer You Are On</A> </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1">Needed Directories</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs021.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs021.htm">Summary</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Setting 
              Up for Printing</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs022.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs022.htm">Q&amp;A</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs019.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs019.htm">Things 
              NT Emacs Does Not Do Well</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs023.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs023.htm">Exercises</A> 
              </FONT></P>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD bgcolor="#DDDDDD">&nbsp;</TD>
    <TD bgcolor="#DDDDDD" align="right" nowrap valign="bottom"> 
      <P class="navigation"><FONT size="2"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Section</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Next 
        Section<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
</TABLE>
<H2><A name="c1"></A> Needed Directories </H2>
<TABLE border="0" cellspacing="0" cellpadding="0">
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="emacs017.htm#Heading42">home</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="emacs017.htm#Heading43">bin</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="emacs017.htm#Heading44">GNU</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="emacs017.htm#Heading46">Postinstallation 
        Bug Fixes</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P> 
      <P class="navigation"><FONT size="1"><A href="emacs017.htm#Heading47">Postinstallation 
        Add-ons</A></FONT></P>
    </TD>
  </TR>
</TABLE>
<BR>
<P><FONT size=2>The
first <A name="Index324"></A><A name="Index325"></A><A name="Index326"></A>things
to do are to make a few adjustments in your system. You need 
<SPAN class=compcode>home</SPAN>,
<SPAN class=compcode>bin</SPAN>,
and 
<SPAN class=compcode>gnu</SPAN>
<A name="Index327"></A><A name="Index328"></A><A name="Index329"></A>directories.
</FONT></P>
<TABLE border="0" width="90%" cellspacing="0" cellpadding="3" align="center"><TR><TD bgcolor="#DDDDDD"><P><FONT size=2><B class="specialgreen">Windows Notes -</B>
If
you work with both<A name="Index330"></A><A name="Index331"></A><A name="Index332"></A>
Windows NT and a version of UNIX (or Linux), you might think about partially
duplicating the UNIX file structure on your NT machine. Then you know where
everything is, and you can move more easily from one to the other. For example,
on Red Hat Linux, the Emacs executable is typically found at 
<SPAN class=compcode>/usr/bin/emacs</SPAN>.
The rest of the distribution is found under 
<SPAN class=compcode>/usr/share/emacs</SPAN>.
Home directories are found under 
<SPAN class=compcode>/home</SPAN>.
Each user has a private directory for executables, called 
<SPAN class=compcode>bin</SPAN>,
under his or her home directory. If you duplicate that structure on your Win32
computer, you have one fewer thing to remember when you shift from one computer
to another.
</FONT></P><P><FONT size=2>
If
you plan to install the Cygwin<A name="Index333"></A><A name="Index334"></A>
utilities (also on the CD-ROM) you should duplicate the UNIX file structure
because many UNIX utilities assume that <A name="Index335"></A><A name="Index336"></A><A name="Index337"></A>file
structure.
</FONT></P></TD></TR></TABLE>
<A name="Heading42"></A>
<H3>
home</H3>
<P><FONT size=2>You
should have<A name="Index338"></A><A name="Index339"></A><A name="Index340"></A>
a personal, or 
<SPAN class=compcode>home</SPAN>,
directory somewhere. Emacs does not require a separate directory, but it is a
good idea. Emacs looks for your personal startup information in the home
directory. It lets you keep personal files (such as your 
<SPAN class=compcode>.emacs</SPAN>
configuration file, your spelling dictionary file, and so on) all in one place,
separate from system and application software such as Emacs itself. This is a
convenience on a single-user system, but it is essential<A name="Index341"></A><A name="Index342"></A><A name="Index343"></A>
when two or more people share a machine. 
</FONT></P>
<TABLE border="0" width="90%" cellspacing="0" cellpadding="3" align="center"><TR><TD bgcolor="#DDDDDD">
      <P><FONT size=2><B class="specialgreen">Windows Notes -</B> Use your <SPAN class=compcode>.emacs</SPAN> 
        file<A name="Index344"></A><A name="Index345"></A><A name="Index346"></A><A name="Index347"></A> 
        to customize Emacs as covered in <A href="emacs010.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs010.htm">Hour 1, &quot;Introduction 
        to Emacs.&quot;</A> I will mention it again later in this hour. UNIX considers 
        a filename with a leading period to be a hidden file, so it is <SPAN class=compcode>.emacs</SPAN> 
        on UNIX. Early versions of NT Emacs used a filename of <SPAN class=compcode>_Emacs</SPAN>, 
        so you will see that filename in email and documentation occasionally. 
        Either one works, but <SPAN class=compcode>.emacs</SPAN> ports handily 
        to and from UNIX, so it is preferable. </FONT></P>
      <P><FONT size=2>
In
fact, all your Emacs data files can be used on UNIX as well as on NT, so if you
use both NT and UNIX, you can port<A name="Index348"></A><A name="Index349"></A><A name="Index350"></A><A name="Index351"></A>
back and forth.
</FONT></P></TD></TR></TABLE><BR>
<P><FONT size=2>On NT 4.0 and Windows 2000, each user has a profile directory, 
  which <A name="Index352"></A><A name="Index353"></A><A name="Index354"></A>might 
  be important if you share your computer with another person. On NT 4.0, it is 
  under <SPAN class=compcode>$WINDIR$\Profiles\&lt;</SPAN><I>your login</I><SPAN class=compcode>&gt;</SPAN>, 
  where <SPAN class=compcode>&lt;</SPAN><I>your login</I><SPAN class=compcode>&gt;</SPAN> 
  is your NT login name. <SPAN class=compcode>$WINDIR$</SPAN> is typically <SPAN class=compcode>c:\winnt40</SPAN>, 
  but that can vary. Under the login, there is a directory, <SPAN class=compcode>PERSONAL</SPAN>, 
  which is a good place to make your home directory. For Windows 2000, <SPAN class=compcode>$WINDIR</SPAN> 
  might be <SPAN class=compcode>C:\WINNT50</SPAN>. On Windows 95/98, multiuser 
  login profiles are usually found under <SPAN class=compcode>C:\WINDOWS\Profiles</SPAN>.</FONT></P>
<P><FONT size=2>Your
home directory is a convenient personal spot to put files you edit often
because it is easy to get to. You can specify the home directory in Emacs by
typing 
<SPAN class=compcode>~/</SPAN>
(or 
<SPAN class=compcode>~\</SPAN>,
Emacs doesn&#039;t care). So you can specify your 
<SPAN class=compcode>.emacs</SPAN>
file with 
<SPAN class=compcode>~/.emacs</SPAN>.
If you share your computer with other people, placing your home directory in
your profile directory lets each person have his<A name="Index355"></A><A name="Index356"></A><A name="Index357"></A>
or her own 
<SPAN class=compcode>.emacs</SPAN>,
diary, and other files. 
</FONT></P>
<TABLE border="0" width="90%" cellspacing="0" cellpadding="3" align="center"><TR><TD bgcolor="#DDDDDD">
      <P><FONT size=2><B class="specialgreen">Windows Notes -</B> While I&#039;m 
        at it, let me offer a short digression on command-line<A name="Index358"></A> 
        syntax. UNIX uses the forward slash (<SPAN class=compcode>/</SPAN>) to 
        separate directory names in paths. Win32 uses backward slashes (<SPAN class=compcode>\</SPAN>). 
        UNIX specifies command-line options with a dash or hyphen (<SPAN class=compcode>-</SPAN>). 
        Windows and its predecessor MS-DOS use both forward slashes (<SPAN class=compcode>/</SPAN>) 
        and hyphens (<SPAN class=compcode>-</SPAN>) to indicate command-line options. 
        Because the hyphen command-line option is common to both environments, 
        I use the hyphen for command-line options. So <SPAN class=compcode>grep 
        -i foo *</SPAN>.runs identically on both Windows NT and Linux. Because 
        Emacs accepts either slash in a path, I find myself using either, but 
        mostly I use the UNIX forward slash. This is because I use Linux a lot, 
        and on Windows NT I often use the Cygnus port of Bash. </FONT></P>
      <P><FONT size=2>
Also,
in elisp source code, as in C source, forward slashes are escape characters. So
in an elisp string such as 
<SPAN class=compcode>//server/deskjet</SPAN>,
back slashes must be doubled. Forward slashes are more <A name="Index359"></A>readable.</FONT></P></TD></TR></TABLE><BR>
<P><FONT size=2>If you aren&#039;t <A name="Index360"></A><A name="Index361"></A><A name="Index362"></A>on 
  a multiuser system, you can put your home directory anywhere you want. You can 
  use your own initials or anything else you want. If you are following UNIX custom, 
  put it at <SPAN class=compcode>c:\home\&lt;</SPAN><I>login-name</I><SPAN class=compcode>&gt;</SPAN>. 
  If you want to stick to the Windows NT custom, put it at <SPAN class=compcode>$WINDIR\Profiles\&lt;</SPAN><I>your 
  login</I><SPAN class=compcode>&gt;</SPAN>. I recommend you put in on the <SPAN class=compcode>C:\</SPAN> 
  drive. If you add a new hard drive or CD-ROM drive to Windows 95/98, your drive 
  letters are at the mercy of the system BIOS, and <SPAN class=compcode>C:</SPAN> 
  is the least likely to be moved, so it is the least likely to be disrupted by 
  adding a new hard drive. (Windows NT users can use the Disk Administrator to 
  reassign drive letters.) </FONT></P>
<P><FONT size=2>If
you are on a multiuser system, make the home directory private to the <A name="Index363"></A><A name="Index364"></A><A name="Index365"></A>individual
user.
</FONT></P>
<A name="Heading43"></A><H3>
bin</H3>
<P><FONT size=2><SPAN class=compcode>bin</SPAN>
is short <A name="Index366"></A><A name="Index367"></A><A name="Index368"></A>for
<I>binary</I>,
and is UNIX&#039;s traditional name for directories that contain executables.
Use 
<SPAN class=compcode>bin</SPAN>
for your own executables, such as programs you have on your computer for your
own use. Put that under your home directory, wherever it is. If you follow UNIX
custom, it will be at 
<SPAN class=compcode>c:\home\&lt;</SPAN><I>login-name</I><SPAN class=compcode>&gt;\bin</SPAN>.
You&#039;ll put it into your path in a minute.
</FONT></P><P><FONT size=2>Emacs
also has a 
<SPAN class=compcode>bin</SPAN>
directory, for its executable files. But you&#039;ll put that where everyone
who uses your computer can get at<A name="Index369"></A><A name="Index370"></A><A name="Index371"></A>
it.
</FONT></P>
<A name="Heading44"></A><H3>
GNU</H3>
<P><FONT size=2>I
use the 
<SPAN class=compcode>GNU</SPAN>
directory <A name="Index372"></A><A name="Index373"></A><A name="Index374"></A>as
a handy place for Free Software Foundation software (of which I use a lot). So
I put all my FSF software under 
<SPAN class=compcode>C:\GNU</SPAN>.
You can call it anything you want, of course. Some programs have problems
dealing with spaces in filenames, so you should not bow to Redmond <A name="Index375"></A><A name="Index376"></A><A name="Index377"></A>and
use 
<SPAN class=compcode>c:/program
files/gnu</SPAN>.</FONT></P>
<TABLE border="0" width="90%" cellspacing="0" cellpadding="3" align="center"><TR><TD bgcolor="#DDDDDD"><P><FONT size=2><B class="specialgreen">Tip -</B>
Normally,
<A name="Index378"></A><A name="Index379"></A>Windows
(and UNIX) treats spaces as delimiters, so spaces indicate to Windows the end
of one command-line argument and the beginning of the next. To help avoid
problems with spaces in filenames, always specify arguments to command lines
(such as in short cuts, associations, and batch files) by quoting them. For
example, later I will show you how to install  gnuclientw. When you create
associations to gnuclientw, put the command-line argument in quotes:
</FONT></P>
      <P><FONT size=2> <SPAN class=compcode>gnuclientw &quot;%1&quot;</SPAN></FONT></P>
      <FONT size=2><P><FONT size=2>
This
encloses in quotes the filename that the association passes to gnuclientw, and
ensures that the association properly handles paths with spaces in<A name="Index380"></A><A name="Index381"></A>
them.
</FONT></P><P><FONT size=2>
To
see how this works, try the following on the command <A name="Index382"></A><A name="Index383"></A>line:</FONT></P>
      <P><FONT size=2> <SPAN class=compcode>dir c:\program files</SPAN></FONT></P>
      <FONT size=2>
      <P><FONT size=2> <SPAN class=compcode>dir &quot;c:\program files&quot;</SPAN></FONT></P>
      </FONT></FONT></TD></TR></TABLE>
<A name="Heading45"></A>
<H4>
Installing
to Hard Disk from the CD-ROM
</H4>
<P><FONT size=2>Now
is the time to<A name="Index384"></A><A name="Index385"></A><A name="Index386"></A><A name="Index387"></A><A name="Index388"></A><A name="Index389"></A>
insert the CD-ROM into the CD-ROM drive and install Windows NT Emacs. It runs
its own setup program on Windows, so all you have to do is follow the
installation program. If you are running Windows 95 or Windows 98, you will
have to reboot to complete the installation.
</FONT></P><P><FONT size=2>Congratulations!
you should now have a working NT Emacs! Go to the GNU Emacs entry in the Start
menu, and click the Emacs entry in it. In a few seconds (depending on how fast
your computer is) you should have Emacs running on your desktop.
</FONT></P><P><FONT size=2>You
now have a minimal installation of NT Emacs (if &quot;minimal installation of
Emacs&quot; is not an oxymoron). There are a number of things you can do to
improve your installation, and I&#039;ll <A name="Index390"></A><A name="Index391"></A><A name="Index392"></A><A name="Index393"></A><A name="Index394"></A><A name="Index395"></A>cover
those next.
</FONT></P>
<A name="Heading46"></A><H3>
Postinstallation
Bug Fixes
</H3>
<P><FONT size=2>NT
Emacs has a<A name="Index396"></A><A name="Index397"></A><A name="Index398"></A>
problem with font locking. Font locking is the Emacs mode that displays
programs in color, making them easier to read. Put the following into your 
<SPAN class=compcode>.emacs</SPAN>
file to work around the font locking <A name="Index399"></A><A name="Index400"></A><A name="Index401"></A>bug:</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode>;; Begin work-around for Emacs 20.3 bug in lazy-lock. See the FAQ under </SPAN>
<SPAN class=compcode>;; upgrading from 19.34.6 to 20.3.1. When doesn&#039;t work on 19.34.6 </SPAN>
<SPAN class=compcode>(if (&gt;= emacs-major-version 20) </SPAN>
<SPAN class=compcode>(when (and (= emacs-major-version 20) (= emacs-minor-version 3)) </SPAN>
<SPAN class=compcode>       (let ((emacs-minor-version 2)) </SPAN>
<SPAN class=compcode>  (require &#039;lazy-lock)))) </SPAN>
<SPAN class=compcode>;; End work-around for Emacs 20.3 bug in lazy-lock </SPAN>
</FONT></PRE>
<A name="Heading47"></A><H3>
Postinstallation
Add-ons
</H3>
<P><FONT size=2>Emacs
on UNIX and other <A name="Index402"></A><A name="Index403"></A>operating
systems depends on a number of external programs to do some of its work. For
example, you can compile programs from within Emacs, but that requires a shell
program such as 
<SPAN class=compcode>cmd.exe</SPAN>
(Windows NT&#039;s command-line shell). Win32 operating systems don&#039;t come
with many of these programs, so you have to get them elsewhere and install them
yourself. I&#039;ll look at ispell for spelling, gnuclient for filename
associations, and VisEmacs for working with Microsoft Visual C++ and Microsoft
Visual <A name="Index404"></A><A name="Index405"></A>Studio.</FONT></P><P><FONT size=2>None
of these add-ons is required for Emacs to run. They are conveniences for some
people and necessities for others. These add-ons bring NT Emacs up to the level
of usefulness that UNIX Emacs <A name="Index406"></A><A name="Index407"></A>users
already enjoy.
</FONT></P>
<A name="Heading48"></A><H4>
ispell
for Spelling
</H4>
<P><FONT size=2>If
you are interested<A name="Index408"></A><A name="Index409"></A><A name="Index410"></A><A name="Index411"></A>
in Emacs only for working with source code, and imagine you aren&#039;t
interested in spell-checking, think again. Many users judge a program by its
user interface, and how well your text messages are spelled is part of how they
will judge your program. One thing Emacs lets you do is block out a text
message in your source code and spell-check it.
</FONT></P><P><FONT size=2>ispell
is on the CD-ROM that accompanies this book. Run the CD-ROM and install <A name="Index412"></A><A name="Index413"></A><A name="Index414"></A><A name="Index415"></A>ispell
from it.
</FONT></P>
<A name="Heading49"></A><H4>
gnuclient
for Associations
</H4>
<P><FONT size=2>In
the Win32 world, it<A name="Index416"></A><A name="Index417"></A><A name="Index418"></A><A name="Index419"></A>
is possible to associate a file extension (the last three or four characters of
a filename, separated from the rest of the filename by a period or dot [.])
with a particular application. You can click a filename, and Windows launches
the associated application and loads that file into it. Often 
<SPAN class=compcode>*.txt</SPAN>
is associated with Notepad or WordPad. 
<SPAN class=compcode>*.html</SPAN>
is associated with a Web browser such as Lynx or Netscape.
</FONT></P><P><FONT size=2>In
a directory window (such as the one you get when you click My Computer), select
the View pull-down menu and the Options entry. Click the tab File Types. You
can select a file type, and edit its association there. You 
<I>could</I>
associate a file type with 
<SPAN class=compcode>runemacs.exe</SPAN>
directly if you wanted to, but that has a major problem: Each time you select a
file, Windows will launch a new instance of Emacs to edit it. Emacs is a bit of
a memory hog; you don&#039;t want to do that. Instead, get gnuclient.
</FONT></P><P><FONT size=2>gnuclient
is a package of four programs: gnuserv, gnuclient, gnuclientw, and gnudoit. The
one in which you are most interested is gnuclientw. It lets you send filenames
to Emacs and have<A name="Index420"></A><A name="Index421"></A><A name="Index422"></A><A name="Index423"></A>
Emacs open them for editing them.
</FONT></P>
<A name="Heading50"></A><H5>
Getting
gnuclient
</H5>
<P><FONT size=2>gnuclient
is on the CD-ROM that accompanies this book. If you installed NT Emacs from the
CD-ROM or are running it live, gnuclient <A name="Index424"></A><A name="Index425"></A><A name="Index426"></A><A name="Index427"></A>is
already installed on your computer.
</FONT></P>
<A name="Heading51"></A><H5>
Using
gnuclient
</H5>
<P><FONT size=2>Put
the following <A name="Index428"></A><A name="Index429"></A><A name="Index430"></A><A name="Index431"></A>into
your 
<SPAN class=compcode>.emacs</SPAN>
file to start the gnuserv server:
</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode>;; start gnuserv on Windows </SPAN>
<SPAN class=compcode>(if (or (eq window-system &#039;w32) (eq window-system &#039;win32)) ;</SPAN>.span class=compcode>Windows NT/95 
<SPAN class=compcode>    (progn </SPAN>
<SPAN class=compcode>      (require &#039;gnuserv) </SPAN>
<SPAN class=compcode>      (setq server-done-function &#039;bury-buffer </SPAN>
<SPAN class=compcode>      gnuserv-frame (car (frame-list))) </SPAN>
<SPAN class=compcode>      (gnuserv-start) </SPAN>
<SPAN class=compcode>      ;;; open buffer in existing frame instead of creating new one... </SPAN>
<SPAN class=compcode>      (setq gnuserv-frame (selected-frame)) </SPAN>
<SPAN class=compcode>      (message &quot;gnuserv started.&quot;))) </SPAN>
</FONT></PRE>
<P><FONT size=2>To
associate file types with Emacs, go back to the File Types window and edit a
suitable association, say for batch files. The file type to edit is MS-DOS
Batch File. Highlight that file type, and click Edit. Under Actions, select
Edit, and then click the Edit button. Either use browse to locate 
<SPAN class=compcode>gnuclientw.exe</SPAN>
or type the full path to it. Include the extension, or Windows will reject the
association. When you insert the command-line parameter, remember to put it in
quotes:
</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode>gnuclientw &quot;%1&quot;</SPAN>
</FONT></PRE>
<P><FONT size=2>If
you are unable to edit the existing Edit action, create a new one, Edit with
Emacs, and go from there.
</FONT></P><P><FONT size=2>One
of the most powerful things you can do is provide a link to gnuclientw in your
SendTo folder. This lets you right-click a file and send it to Emacs to open,
whether you have associated it with Emacs or not.
</FONT></P><P><FONT size=2>Open
the SendTo folder on your computer. On NT, there is a SendTo folder for each
profile. On Windows 95/98, there is one under the 
<SPAN class=compcode>c:\windows</SPAN>
directory. There, create a shortcut pointing to<A name="Index432"></A><A name="Index433"></A><A name="Index434"></A><A name="Index435"></A>
<SPAN class=compcode>gnuclientw.exe</SPAN>,
with the parameter in quotes.
</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode>Insert Illo: emacs.prop.gif</SPAN>
</FONT></PRE>
<A name="Heading52"></A><H4>
VisEmacs
for Visual C++
</H4>
<P><FONT size=2>You
can find VisEmacs <A name="Index436"></A><A name="Index437"></A><A name="Index438"></A>on
the CD-ROM. If you are using a non-Intel processor, you should be able to
compile from the extracted source. If you are accustomed to working with the
Microsoft Visual products, you should have no problem following Christopher
Payne&#039;s installation instructions in the file 
<SPAN class=compcode>ReadMe.txt</SPAN>.</FONT></P>
<P><FONT size=2>There are further notes in the FAQ on integrating Visual C++ and 
  NT Emacs. They are unfortunately slightly out of date, as they were written 
  for Emacs 19.34.1 on Windows 95, using Visual C++ 4.0 Standard Edition. Emacs 
  is now up to 20.3.1, and Visual C++ up to <A name="Index439"></A><A name="Index440"></A><A name="Index441"></A>Version 
  6. </FONT></P>
<TABLE border="0" width="99%" cellspacing="0" cellpadding="3">
  <TR> 
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif"  bgcolor="#666699"> 
      <P> <FONT color="#FFFFFF"><B>Sams Teach Yourself Emacs<FONT size="1"></FONT> 
        in 24 Hours</B> </FONT></P>
    </TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699"><FONT size="2"><IMG src="http://learn.tsinghua.edu.cn:8080/2001315450/style/dot.gif" tppabs="http://freebooks.by.ru/view/style/dot.gif" width="10" height="1"></FONT></TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699" nowrap align="right"> 
      <P><A href="index.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/index.htm"><FONT size="2" color="#FFFFFF">Contents</FONT></A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="bkindex.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/bkindex.htm"><FONT size="2" color="#FFFFFF">Index</FONT></A></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#AAAAAA" height="16"> 
      <P><FONT size="2">Hour 2: Using Emacs in Microsoft Windows</FONT></P>
    </TD>
    <TD bgcolor="#AAAAAA" height="16"><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
    <TD bgcolor="#AAAAAA" height="16" align="right" nowrap> 
      <P><FONT size="2"><A href="emacs010.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs010.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Hour</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs025.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs025.htm">Next 
        Hour<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#DDDDDD"> 
      <TABLE border="0" cellspacing="0" cellpadding="0" dwcopytype="CopyTableRow">
        <TR valign="top"> 
          <TD> 
            <P></P>
            <P><FONT size="2">Sections in this Hour:</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1">What 
              Is NT Emacs?</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">How to 
              Tell Which Computer You Are On</A> </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1">Needed Directories</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs021.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs021.htm">Summary</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Setting 
              Up for Printing</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs022.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs022.htm">Q&amp;A</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs019.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs019.htm">Things 
              NT Emacs Does Not Do Well</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs023.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs023.htm">Exercises</A> 
              </FONT></P>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD bgcolor="#DDDDDD">&nbsp;</TD>
    <TD bgcolor="#DDDDDD" align="right" nowrap valign="bottom"> 
      <P class="navigation"><FONT size="2"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Section</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Next 
        Section<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
</TABLE>
<P class="copyright"><FONT size=2>&#169; Copyright Macmillan USA. All rights reserved.</FONT> 
</P>
</BODY>

</HTML>
