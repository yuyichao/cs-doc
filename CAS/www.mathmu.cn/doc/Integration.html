<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta name="generator" content="Muse">
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" charset="utf-8" media="all"
          href="../main.css" >
    <link rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon">
    <script type="text/javascript" charset="utf-8" src="../main.js"></script>
    <title>符号积分 - maTH&mu; - 计算机代数系统</title>
  </head>
  <body>
<div id="banner"></div><!-- banner -->    
<div id="header">
    <h1>符号积分
  </h1>
  <a name="top"></a>
  <div id="tab">
  <ul>
    <li><a href="../index.html" title="主页"><span>主页</span></a></li>
    <li><a href="../Doc.html" title="文档"><span>文档</span></a></li>
    <li><a href="../Dev.html" title="开发"><span>开发</span></a></li>
    <li><a href="http://groups.google.com/group/maTHmU?hl=zh-CN" title="论坛"><span>论坛</span></a></li>
    <li><a href="../JoinUs.html" title="加入我们"><span>加入我们</span></a></li>
  </ul>
  </div><!-- tab -->
</div><!-- header -->
<div id="container">
  <div id="body">
    <div id="leftshadow">
      <div id="page"> 
 <!-- Page published by Emacs Muse begins here -->
<a href="Integration.html#" onClick="ShowHide(content)">隐藏目录</a>
<div id="content" class="contents">
<dl>
  <dt>
    <a href="Integration.html#sec1">有理函数积分</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="Integration.html#sec2">部分分式分解</a>
      </dt>
      <dt>
	<a href="Integration.html#sec3">Hermite方法</a>
      </dt>
      <dt>
	<a href="Integration.html#sec4">Horowitz-Ostrogradsky方法</a>
      </dt>
      <dt>
	<a href="Integration.html#sec5">Rothstein-Trager方法</a>
      </dt>
      <dt>
	<a href="Integration.html#sec6">Lazard-Rioboo-Trager方法</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="Integration.html#sec7">Liouville定理</a>
  </dt>
  <dt>
    <a href="Integration.html#sec8">超越对数函数积分</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="Integration.html#sec9">分解引理</a>
      </dt>
      <dt>
	<a href="Integration.html#sec10">多项式部分</a>
      </dt>
      <dt>
	<a href="Integration.html#sec11">有理部分与对数部分</a>
      </dt>
    </dl>
  </dd>
  <dt>
    <a href="Integration.html#sec12">超越指数函数积分</a>
  </dt>
  <dd>
    <dl>
      <dt>
	<a href="Integration.html#sec13">分解引理</a>
      </dt>
      <dt>
	<a href="Integration.html#sec14">多项式部分</a>
      </dt>
      <dt>
	<a href="Integration.html#sec15">有理部分和对数部分</a>
      </dt>
    </dl>
  </dd>
</dl>
</div>

<p><span class="nocite"><a class="cite" href="Integration.html#ref-1" name="cite-1">[1]</a></span>
<span class="nocite"><a class="cite" href="Integration.html#ref-2" name="cite-2">[2]</a></span></p>

<h2><a name="sec1" id="sec1"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>有理函数积分</h2>

<h3><a name="sec2" id="sec2"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>部分分式分解</h3>

<p class="first">最简单的多项式函数无需赘言，因此我们首先考虑有理函数<img src="latex/latex2png-Integration_121992097_-16.gif" alt="$\dfrac{q(x)}{r(x)}$" class="latex-inline" style="vertical-align: -16px" width="31" height="40">的符号积分，其中<img src="latex/latex2png-Integration_99559432_-5.gif" alt="$q(x),r(x)\in \mathbb{C}[x]$" class="latex-inline" style="vertical-align: -5px" width="117" height="18">，满足<img src="latex/latex2png-Integration_97549487_-5.gif" alt="$(q(x),r(x))=1$" class="latex-inline" style="vertical-align: -5px" width="109" height="18">，不失一般性还可假设<img src="latex/latex2png-Integration_95647258_-5.gif" alt="$\deg q(x)<\deg r(x)$" class="latex-inline" style="vertical-align: -5px" width="136" height="18">。最朴素的办法是利用部分分式分解。</p>


<div class="lemma">
<span class="theorem-header">引理1<a name="le:partial"></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_170883152_-5.gif" alt="$(f(x),g(x))=1$" class="latex-inline" style="vertical-align: -5px" width="112" height="18">，<img src="latex/latex2png-Integration_227586464_-5.gif" alt="$\deg h(x)<\deg f(x)g(x)$" class="latex-inline" style="vertical-align: -5px" width="171" height="18">，则有<img src="latex/latex2png-Integration_130774850_.gif" alt="$$\frac{h(x)}{f(x)g(x)}=\frac{f_1(x)}{f(x)}+\frac{g_1(x)}{g(x)},$$" class="latex-display" width="580" height="41">其中<img src="latex/latex2png-Integration_77612541_-5.gif" alt="$\deg f_1(x)<\deg f(x)$" class="latex-inline" style="vertical-align: -5px" width="146" height="18">，<img src="latex/latex2png-Integration_190827011_-5.gif" alt="$\deg g_1(x)<\deg g(x)$" class="latex-inline" style="vertical-align: -5px" width="144" height="18">。


</div>

<div class="proof">
<span class="proof-header">证明</span>
由<img src="latex/latex2png-Integration_170883152_-5.gif" alt="$(f(x),g(x))=1$" class="latex-inline" style="vertical-align: -5px" width="112" height="18">知存在<img src="latex/latex2png-Integration_223185247_-5.gif" alt="$u(x) $" class="latex-inline" style="vertical-align: -5px" width="30" height="18">，<img src="latex/latex2png-Integration_220951611_-5.gif" alt="$v(x)$" class="latex-inline" style="vertical-align: -5px" width="29" height="18">满足<img src="latex/latex2png-Integration_217285108_-5.gif" alt="$f(x)u(x)+g(x)v(x)=1$" class="latex-inline" style="vertical-align: -5px" width="175" height="18">，于是<img src="latex/latex2png-Integration_162110196_.gif" alt="$$\frac{h(x)}{f(x)g(x)}=\frac{h(x)(f(x)u(x)+g(x)v(x))}{f(x)g(x)}=\frac{h(x)v(x)}{f(x)}+\frac{h(x)u(x)}{g(x)}.$$" class="latex-display" width="580" height="41">令<img src="latex/latex2png-Integration_266035414_-5.gif" alt="$f_1(x)=h(x)v(x)\bmod f(x)$" class="latex-inline" style="vertical-align: -5px" width="193" height="18">，<img src="latex/latex2png-Integration_2334522_-5.gif" alt="$g_1(x)=h(x)u(x)\bmod g(x)$" class="latex-inline" style="vertical-align: -5px" width="193" height="18">即得。
<span class="proof-end">□</span>

</div>

<p>设<img src="latex/latex2png-Integration_18104726_-15.gif" alt="$r(x)=\prod\limits_{i=1}^n(x-a_i)^{n_i}$" class="latex-inline" style="vertical-align: -15px" width="142" height="36">，反复利用引理<a class="ref-th" href="Integration.html#le:partial">1</a>则有<img src="latex/latex2png-Integration_58268364_.gif" alt="$$\frac{q(x)}{r(x)}=\sum_{i=1}^n\frac{b_i(x)}{(x-a_i)^{n_i}},$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_3756352_-5.gif" alt="$\deg b_i(x)<n_i$" class="latex-inline" style="vertical-align: -5px" width="100" height="18">。再将<img src="latex/latex2png-Integration_47473643_-5.gif" alt="$b_i(x)$" class="latex-inline" style="vertical-align: -5px" width="33" height="18">在<img src="latex/latex2png-Integration_255030950_-2.gif" alt="$x=a_i$" class="latex-inline" style="vertical-align: -2px" width="46" height="10">处展开可得<img src="latex/latex2png-Integration_108632132_.gif" alt="$$\frac{q(x)}{r(x)}=\sum_{i=1}^n\sum_{j=1}^{n_i}\frac{b_{ij}}{(x-a_i)^j},$$" class="latex-display" width="580" height="48">其中<img src="latex/latex2png-Integration_176710634_-5.gif" alt="$b_{ij}$" class="latex-inline" style="vertical-align: -5px" width="18" height="17">为常数。于是得到
<img src="latex/latex2png-Integration_247609236_.gif" alt="
\begin{equation*}
\int\frac{q(x)}{r(x)}\,dx=\sum_{i=1}^nb_{i1}\ln (x-a_i)-\sum_{i=1}^n\sum_{j=2}^{n_i}\frac{b_{ij}}{(j-1)(x-a_i)^{j-1}}.\tag{1}
\end{equation*}
" class="latex-display" name="eqref-1" width="580" height="48"></p>

<p>有理函数符号积分的问题在理论上解决了，即所有有理函数的积分均可由有理函数和对数函数表示，分别称为积分的有理部分和对数部分。但还有几个不得不处理的问题：一方面需要在<img src="latex/latex2png-Integration_26235984_-1.gif" alt="$\mathbb{C}$" class="latex-inline" style="vertical-align: -1px" width="12" height="13">上完全分解<img src="latex/latex2png-Integration_220951610_-5.gif" alt="$r(x)$" class="latex-inline" style="vertical-align: -5px" width="28" height="18">，而精确地做到这一点并不总那么容易，另一方面我们更希望看到的是，在算法的计算中除了用于表示最终积分的数以外，不要出现其他系数域扩域中的代数数。</p>

<div class="problem">
<span class="proof-header">例1<a name=""></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_260767772_-5.gif" alt="$q(x)=2x$" class="latex-inline" style="vertical-align: -5px" width="70" height="18">，<img src="latex/latex2png-Integration_106529187_-5.gif" alt="$r(x)=x^2+1\in \mathbb{Q}[x]$" class="latex-inline" style="vertical-align: -5px" width="148" height="19">，则<img src="latex/latex2png-Integration_216137080_-16.gif" alt="$\displaystyle\int\frac{q(x)}{r(x)}\,dx=\ln(x^2+1)$" class="latex-inline" style="vertical-align: -16px" width="166" height="40">，而在<img src="latex/latex2png-Integration_26235984_-1.gif" alt="$\mathbb{C}$" class="latex-inline" style="vertical-align: -1px" width="12" height="13">上分解<img src="latex/latex2png-Integration_220951610_-5.gif" alt="$r(x)$" class="latex-inline" style="vertical-align: -5px" width="28" height="18">需要引入额外的代数数<img src="latex/latex2png-Integration_42169362_0.gif" alt="$i$" class="latex-inline" style="vertical-align: 0px" width="5" height="12">。
<span class="example-end">◇</span>

</div>




<h3><a name="sec3" id="sec3"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Hermite方法</h3>

<p class="first">Hermite方法使用多项式的无平方分解来代替完全分解，而无平方分解可以在系数域中完成。设<img src="latex/latex2png-Integration_220951610_-5.gif" alt="$r(x)$" class="latex-inline" style="vertical-align: -5px" width="28" height="18">的无平方分解为<img src="latex/latex2png-Integration_2641416_-15.gif" alt="$r(x)=\prod\limits_{i=1}^nr_i(x)^i$" class="latex-inline" style="vertical-align: -15px" width="116" height="36">，其中<img src="latex/latex2png-Integration_47473387_-5.gif" alt="$r_i(x)$" class="latex-inline" style="vertical-align: -5px" width="33" height="18">无平方因子且两两互素。从而<img src="latex/latex2png-Integration_91207694_.gif" alt="$$\frac{q(x)}{r(x)}=\frac{q(x)}{\prod\limits_{i=1}^nr_i(x)^i}=\sum_{i=1}^n\frac{q_i(x)}{r_i(x)^i},$$" class="latex-display" width="580" height="61">其中<img src="latex/latex2png-Integration_102081924_-5.gif" alt="$\deg q_i(x)<\deg r_i(x)^i$" class="latex-inline" style="vertical-align: -5px" width="153" height="19">。因此我们只需要考虑积分<img src="latex/latex2png-Integration_107079193_-16.gif" alt="$\displaystyle\int\frac{q_i(x)}{r_i(x)^i}\,dx$" class="latex-inline" style="vertical-align: -16px" width="84" height="40">即可。</p>

<p>由于<img src="latex/latex2png-Integration_47473387_-5.gif" alt="$r_i(x)$" class="latex-inline" style="vertical-align: -5px" width="33" height="18">无平方因子，故<img src="latex/latex2png-Integration_81191351_-5.gif" alt="$(r_i(x),r_i'(x))=1$" class="latex-inline" style="vertical-align: -5px" width="119" height="18">，可设<img src="latex/latex2png-Integration_55087306_-5.gif" alt="$a(x)r_i(x)+b(x)r_i'(x)=1$" class="latex-inline" style="vertical-align: -5px" width="181" height="18">，代入进行分部积分
<img src="latex/latex2png-Integration_220727098_.gif" alt="
\begin{align*}
  \int\frac{q_i(x)}{r_i(x)^i }&\,dx =\int\frac{q_i(x)(a(x)r_i(x)+b(x)r_i'(x))}{r_i(x)^i}\,dx \\
  &=\int\frac{q_i(x)a(x)}{r_i(x)^{i-1}}\,dx +\int\frac{q_i(x)b(x)r_i'(x)}{r_i(x)^i}\,dx  \\
  &=\int\frac{q_i(x)a(x)+(q_i(x)b(x))'/(i-1)}{r_i^{i-1}}\,dx -\frac{1}{i-1}\frac{q_i(x)b(x)}{r_i^{i-1}}.
\end{align*}
" class="latex-display" width="580" height="134">
为了简便起见，我们将省略变元<img src="latex/latex2png-Integration_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="9" height="8">与记号<img src="latex/latex2png-Integration_135427090_0.gif" alt="$dx$" class="latex-inline" style="vertical-align: 0px" width="18" height="12">，以下的积分与导数总是对<img src="latex/latex2png-Integration_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="9" height="8">而言的，例如上式即可简写为
<img src="latex/latex2png-Integration_176750575_.gif" alt="
\begin{equation*}
\int\frac{q_i}{r_i^i}=\int\frac{q_ia+(q_ib)'/(i-1)}{r_i^{i-1}}-\frac{1}{i-1}\frac{q_ib}{r_i^{i-1}}.\tag{2}
\end{equation*}
" class="latex-display" name="eqref-2" width="580" height="42"></p>

<p>此过程称为Hermite约化过程。通过一次分部积分，被积函数分母中<img src="latex/latex2png-Integration_265063404_-2.gif" alt="$r_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">的次数便降低一次，如此续行即可完全得到积分的有理部分。</p>



<h3><a name="sec4" id="sec4"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Horowitz-Ostrogradsky方法</h3>

<p class="first">Hermite方法避免了完全分解，但仍要求无平方分解和关于<img src="latex/latex2png-Integration_265063404_-2.gif" alt="$r_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">的部分分式分解。Horowitz-Ostrogradsky方法则不需要其他工具，通过待定系数法将问题归结为线性方程的求解问题。</p>

<p>设<img src="latex/latex2png-Integration_222910492_.gif" alt="$$\frac{q}{r}=\frac{q_1}{r_1}+\int\frac{q_2}{r_2},$$" class="latex-display" width="580" height="38">其中<img src="latex/latex2png-Integration_217015577_-14.gif" alt="$\dfrac{q_1}{r_1}$" class="latex-inline" style="vertical-align: -14px" width="15" height="33">为积分的有理部分，由部分分式的结果可知<img src="latex/latex2png-Integration_174210081_-5.gif" alt="$r_1=(r,r')$" class="latex-inline" style="vertical-align: -5px" width="76" height="18">，<img src="latex/latex2png-Integration_45324847_-5.gif" alt="$r_2=r/r_1$" class="latex-inline" style="vertical-align: -5px" width="66" height="18">。求导得到
<img src="latex/latex2png-Integration_163649227_.gif" alt="
\begin{align*}
  \frac{q}{r}&=\left(\frac{q_1}{r_1}\right)'+\frac{q_2}{r_2} \\
  &=\frac{q_1'r_1-q_1r_1'}{r_1^2}+\frac{q_2r_1}{r} \\
  &=\frac{q_1'r_2-q_1r_1'r_2/r_1+q_2r_1}{r}.
\end{align*}
" class="latex-display" width="580" height="131">
从而问题归结为求<img src="latex/latex2png-Integration_253981716_-4.gif" alt="$q_1$" class="latex-inline" style="vertical-align: -4px" width="13" height="12">，<img src="latex/latex2png-Integration_254047252_-4.gif" alt="$q_2$" class="latex-inline" style="vertical-align: -4px" width="13" height="12">满足<img src="latex/latex2png-Integration_233480773_-5.gif" alt="$q=q_1'r_2-q_1r_1'r_2/r_1+q_2r_1$" class="latex-inline" style="vertical-align: -5px" width="196" height="18">且<img src="latex/latex2png-Integration_85292344_-4.gif" alt="$\deg q_1<\deg r_1$" class="latex-inline" style="vertical-align: -4px" width="106" height="16">，<img src="latex/latex2png-Integration_86406456_-4.gif" alt="$\deg q_2<\deg r_2$" class="latex-inline" style="vertical-align: -4px" width="106" height="16">。以<img src="latex/latex2png-Integration_253981716_-4.gif" alt="$q_1$" class="latex-inline" style="vertical-align: -4px" width="13" height="12">，<img src="latex/latex2png-Integration_254047252_-4.gif" alt="$q_2$" class="latex-inline" style="vertical-align: -4px" width="13" height="12">的系数作为未知变量，这是一个至多<img src="latex/latex2png-Integration_246637038_-4.gif" alt="$\deg r$" class="latex-inline" style="vertical-align: -4px" width="35" height="16">维的线性方程组问题。</p>

<div class="remark">
<span class="proof-header">注1<a name=""></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_239236131_-4.gif" alt="$\deg r=n$" class="latex-inline" style="vertical-align: -4px" width="68" height="16">，则Hermite方法的时间复杂度为<img src="latex/latex2png-Integration_72640302_-5.gif" alt="$O(M(n)\log n)$" class="latex-inline" style="vertical-align: -5px" width="101" height="18"><span class="cite"><a class="cite" href="Integration.html#ref-3" name="cite-3">[3]</a></span>，其中<img src="latex/latex2png-Integration_57969606_-5.gif" alt="$M(n)$" class="latex-inline" style="vertical-align: -5px" width="39" height="18">为乘法的复杂度。而Horowitz-Ostrogradsky方法的复杂度为<img src="latex/latex2png-Integration_22781230_-5.gif" alt="$O(n^3)$" class="latex-inline" style="vertical-align: -5px" width="41" height="19">（解线性方程组），尽管渐进意义上后者要比前者慢将近两个量级，但在实践中还是要分析具体情况而定。


</div>


<h3><a name="sec5" id="sec5"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Rothstein-Trager方法</h3>

<p class="first">下面的问题是如何求出对数部分，因此我们设<img src="latex/latex2png-Integration_220951610_-5.gif" alt="$r(x)$" class="latex-inline" style="vertical-align: -5px" width="28" height="18">无平方因子的首一多项式，并可设<img src="latex/latex2png-Integration_209615545_.gif" alt="$$\int\frac{q}{r}=\sum_{i=1}^mc_i\ln v_i,$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_20149268_-2.gif" alt="$c_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">为互不相同的常数，<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">为无平方因子的首一多项式，两两互素（可以通过合并项来满足这些条件）。求导得到<img src="latex/latex2png-Integration_182720712_.gif" alt="$$\frac{q}{r}=\sum_{i=1}^m\frac{c_iv_i'}{v_i}.$$" class="latex-display" width="580" height="45">由于<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">无平方因子且两两互素可知<img src="latex/latex2png-Integration_6859101_.gif" alt="$$r=\prod\limits_{i=1}^mv_i.$$" class="latex-display" width="580" height="45">记<img src="latex/latex2png-Integration_7555458_-18.gif" alt="$u_i=\prod\limits_{j\ne i}v_i$" class="latex-inline" style="vertical-align: -18px" width="74" height="31">，则有<img src="latex/latex2png-Integration_251820921_.gif" alt="$$r'=\sum_{i=1}^mu_iv_i'$$" class="latex-display" width="580" height="45">及<img src="latex/latex2png-Integration_41081445_.gif" alt="$$q=\sum_{i=1}^mc_iu_iv_i'.$$" class="latex-display" width="580" height="45">于是对于<img src="latex/latex2png-Integration_162502492_-3.gif" alt="$1\le k\le n$" class="latex-inline" style="vertical-align: -3px" width="71" height="15">
<img src="latex/latex2png-Integration_140654858_.gif" alt="
\begin{equation*}
  \begin{aligned}
    (q-c_kr',r)&=(q-c_kr',\prod_{i=1}^mv_i) \\
    &=\prod_{i=1}^m(q-c_kr',v_i) \\
    &=\prod_{i=1}^m\left(\sum_{j=1}^m(c_j-c_k)u_jv_j',v_i\right)\\
    &=v_k.
  \end{aligned}  \tag{3}
\end{equation*}
" class="latex-display" name="eqref-3" width="580" height="196">
最后一个等式成立是因为
<img src="latex/latex2png-Integration_93740083_.gif" alt="
\begin{equation*}
  ((c_j-c_k)u_jv_j',v_i)=
  \begin{cases}
    v_i & i\ne j, \\
    1 & i=j, i\ne k, \\
    v_i & i=j, i=k,
  \end{cases}
\end{equation*}
" class="latex-display" width="580" height="90">
从而
<img src="latex/latex2png-Integration_160991440_.gif" alt="
\begin{equation*}
  \left(\sum_{j=1}^m(c_j-c_k)u_jv_j',v_i\right)=
  \begin{cases}
    1 & i\ne k, \\
    v_i & i=k.
  \end{cases}
\end{equation*}
" class="latex-display" width="580" height="61"></p>

<p>由式<a class="ref-eq" href="Integration.html#eqref-3"  title="公式(3)">(3)</a>可以看出，当我们找出系数<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">后即可通过最大公因子的计算求出<img src="latex/latex2png-Integration_197823468_-2.gif" alt="$v_k$" class="latex-inline" style="vertical-align: -2px" width="15" height="10">。如何求出<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">呢？同样的论证可以知道<img src="latex/latex2png-Integration_216550962_-5.gif" alt="$(q-yr',r)>1\Leftrightarrow \exists 1\le k\le m,y=c_k$" class="latex-inline" style="vertical-align: -5px" width="271" height="18">，而<img src="latex/latex2png-Integration_239234908_-5.gif" alt="$(q-yr',r)>1\Leftrightarrow\res_x(q-yr',r)=0$" class="latex-inline" style="vertical-align: -5px" width="276" height="18">（此结式称为Rothstein-Trager结式），故求解关于<img src="latex/latex2png-Integration_43217938_-4.gif" alt="$y$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">的方程<img src="latex/latex2png-Integration_60443962_-5.gif" alt="$\res_x(q-yr',r)=0$" class="latex-inline" style="vertical-align: -5px" width="143" height="18">即可得到所有的系数<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">。</p>

<div class="problem">
<span class="proof-header">例2<a name=""></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_91331112_-2.gif" alt="$r=x^3+x+1$" class="latex-inline" style="vertical-align: -2px" width="104" height="16">，<img src="latex/latex2png-Integration_183745384_-4.gif" alt="$q=3x^2+1$" class="latex-inline" style="vertical-align: -4px" width="83" height="18">，则Rothstein-Trager结式<img src="latex/latex2png-Integration_267942214_-5.gif" alt="$\res_x(q-yr',r)=\res_x((1-y)(3x^2+1),x^3+x+1)=-31(y-1)^3$" class="latex-inline" style="vertical-align: -5px" width="489" height="19">。从而方程<img src="latex/latex2png-Integration_60443962_-5.gif" alt="$\res_x(q-yr',r)=0$" class="latex-inline" style="vertical-align: -5px" width="143" height="18">有唯一的根<img src="latex/latex2png-Integration_184323052_-4.gif" alt="$y=1$" class="latex-inline" style="vertical-align: -4px" width="38" height="15">，最大公因子<img src="latex/latex2png-Integration_54266165_-5.gif" alt="$(q-yr',r)=r=x^3+x+1$" class="latex-inline" style="vertical-align: -5px" width="203" height="19">，故<img src="latex/latex2png-Integration_51471403_.gif" alt="$$\int\frac{q}{r}=\ln (x^3+x+1)$$" class="latex-display" width="580" height="37">即为积分结果。
<span class="example-end">◇</span>

</div>

<div class="remark">
<span class="proof-header">注2<a name=""></a></span><span class="theorem-name"></span>
Rothstein-Trager方法的时间复杂度为<img src="latex/latex2png-Integration_72650169_-5.gif" alt="$O(nM(n)\log n)$" class="latex-inline" style="vertical-align: -5px" width="111" height="18"><span class="cite"><a class="cite" href="Integration.html#ref-3" name="cite-3">[3]</a></span>。


</div>

<div class="remark">
<span class="proof-header">注3<a name=""></a></span><span class="theorem-name"></span>
对于高次Rothstein-Trager结式，其根可能无法显式地表达出来。设<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">无平方因子，<img src="latex/latex2png-Integration_42497042_0.gif" alt="$n$" class="latex-inline" style="vertical-align: 0px" width="10" height="8">个根为<img src="latex/latex2png-Integration_13405164_-2.gif" alt="$a_i$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">（<img src="latex/latex2png-Integration_28672954_-4.gif" alt="$i=1,\ldots,n$" class="latex-inline" style="vertical-align: -4px" width="83" height="16">），不难求得<a class="ref-eq" href="Integration.html#eqref-1"  title="公式(1)">(1)</a>中的<img src="latex/latex2png-Integration_194536426_-2.gif" alt="$b_{i1}$" class="latex-inline" style="vertical-align: -2px" width="18" height="14">，此时可直接将积分表示为<img src="latex/latex2png-Integration_234168104_.gif" alt="$$\int\frac{q}{r}=\sum_{i=1}^n\frac{q(a_i)}{r'(a_i)}\ln(x-a_i),$$" class="latex-display" width="580" height="45">便于进一步的运算。


</div>

<div class="remark">
<span class="proof-header">注4<a name=""></a></span><span class="theorem-name"></span>
对于实值函数的积分还应将<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">中互为相反数对应的对数项合并为更常见的<img src="latex/latex2png-Integration_2419729_0.gif" alt="$\arctan$" class="latex-inline" style="vertical-align: 0px" width="45" height="11">项。


</div>



<h3><a name="sec6" id="sec6"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Lazard-Rioboo-Trager方法</h3>

<p class="first">Rothstein-Trager方法解决了引入不必要扩张常数的问题，但仍需要计算许多代数数域上多项式的最大公因子，Lazard-Rioboo-Trager方法是对此的一个改进，只需要无平方分解和若干带余除法即可。</p>

<p>设<img src="latex/latex2png-Integration_69061198_-15.gif" alt="$r=\prod\limits_{i=1}^n(x-a_i)$" class="latex-inline" style="vertical-align: -15px" width="107" height="36">，<img src="latex/latex2png-Integration_142842032_-5.gif" alt="$h=\res_x(q-yr',r)$" class="latex-inline" style="vertical-align: -5px" width="143" height="18">，由结式的性质得到<img src="latex/latex2png-Integration_101415744_.gif" alt="$$h=c\cdot\prod_{i=1}^n(q(a_j)-yr'(a_j)),$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_41776146_0.gif" alt="$c$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">为非零常数。从而<img src="latex/latex2png-Integration_42103826_0.gif" alt="$h$" class="latex-inline" style="vertical-align: 0px" width="9" height="12">中<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">的重数为满足<img src="latex/latex2png-Integration_153448479_-5.gif" alt="$q(a_i)-c_ir'(a_i)$" class="latex-inline" style="vertical-align: -5px" width="107" height="18">的<img src="latex/latex2png-Integration_42169362_0.gif" alt="$i$" class="latex-inline" style="vertical-align: 0px" width="5" height="12">的个数。而
<img src="latex/latex2png-Integration_229124617_.gif" alt="
\begin{align*}
  v_k&=(q-c_kr',r)\\
  &=(q-c_kr',\prod_{i=1}^n(x-a_i)) \\
  &=\prod_{q(a_i)-c_kr'(a_i)=0}(x-a_i)
\end{align*}
" class="latex-display" width="580" height="125">
可知<img src="latex/latex2png-Integration_195070941_-4.gif" alt="$\deg v_k$" class="latex-inline" style="vertical-align: -4px" width="43" height="16">等于<img src="latex/latex2png-Integration_42103826_0.gif" alt="$h$" class="latex-inline" style="vertical-align: 0px" width="9" height="12">中<img src="latex/latex2png-Integration_20280340_-2.gif" alt="$c_k$" class="latex-inline" style="vertical-align: -2px" width="14" height="10">的重数。由此出发可知：设被积函数的系数域为<img src="latex/latex2png-Integration_42497042_0.gif" alt="$F$" class="latex-inline" style="vertical-align: 0px" width="10" height="8">，则只需要在<img src="latex/latex2png-Integration_262013723_-5.gif" alt="$F(y)[x]$" class="latex-inline" style="vertical-align: -5px" width="51" height="18">中对<img src="latex/latex2png-Integration_97089182_-4.gif" alt="$q-yr'$" class="latex-inline" style="vertical-align: -4px" width="49" height="17">和<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">做Euclid除法，设<img src="latex/latex2png-Integration_34893828_-5.gif" alt="$W_i(x,y)\in F(y)[x]$" class="latex-inline" style="vertical-align: -5px" width="131" height="18">为余式序列中关于<img src="latex/latex2png-Integration_43152402_0.gif" alt="$x$" class="latex-inline" style="vertical-align: 0px" width="9" height="8">次数为<img src="latex/latex2png-Integration_42169362_0.gif" alt="$i$" class="latex-inline" style="vertical-align: 0px" width="5" height="12">的多项式，则有<img src="latex/latex2png-Integration_186677878_-5.gif" alt="$v_k=W_{\deg v_k}(x,c_k)$" class="latex-inline" style="vertical-align: -5px" width="135" height="18">。另外，如果用多项式余式序列(PRS)算法来计算结式<img src="latex/latex2png-Integration_42103826_0.gif" alt="$h$" class="latex-inline" style="vertical-align: 0px" width="9" height="12">的话，<img src="latex/latex2png-Integration_46959596_-2.gif" alt="$W_i$" class="latex-inline" style="vertical-align: -2px" width="21" height="14">的计算可以与结式的计算同时进行。</p>



<h2><a name="sec7" id="sec7"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>Liouville定理</h2>

<p class="first">从直观上来看，所有有理函数总是可以积出。这里“积出”的精确含义是，可以找到一个初等函数作为被积函数的原函数。为了将问题的本质看得更清楚，我们引入如下定义。</p>

<div class="definition">
<span class="theorem-header">定义1<a name=""></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_142767122_0.gif" alt="$F $" class="latex-inline" style="vertical-align: 0px" width="12" height="12">为一个特征不为零的域，映射<img src="latex/latex2png-Integration_111538369_-1.gif" alt="$D:F\rightarrow F$" class="latex-inline" style="vertical-align: -1px" width="79" height="13">满足<img src="latex/latex2png-Integration_254376160_-4.gif" alt="$\forall f,g\in F$" class="latex-inline" style="vertical-align: -4px" width="66" height="16">有
<img src="latex/latex2png-Integration_58888970_.gif" alt="
\begin{align*}
  D(f+g)&=D(f)+D(g), \\
  D(f\cdot g)&=f\cdot D(g)+g\cdot D(f).
\end{align*}
" class="latex-display" width="580" height="49">
则<img src="latex/latex2png-Integration_42365970_0.gif" alt="$D$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">称为<img src="latex/latex2png-Integration_42497042_0.gif" alt="$F$" class="latex-inline" style="vertical-align: 0px" width="10" height="8">上的微分算子，<img src="latex/latex2png-Integration_74160858_-5.gif" alt="$(F, D)$" class="latex-inline" style="vertical-align: -5px" width="43" height="18">称为一个微分代数或者微分域。集合<img src="latex/latex2png-Integration_195169823_-5.gif" alt="$C(F)=\{c\in F\mid D(c)=0\}$" class="latex-inline" style="vertical-align: -5px" width="194" height="18">中的元素称为常数。


</div>
容易验证<img src="latex/latex2png-Integration_42365970_0.gif" alt="$D$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">拥有所有分析学教程中求导运算的基本性质，我们在这里仅仅罗列而略去证明<span class="cite"><a class="cite" href="Integration.html#ref-2" name="cite-2">[2]</a></span>。

<div class="proposition">
<span class="theorem-header">命题1<a name=""></a></span><span class="theorem-name">(微分代数的基本性质)</span>

<ol>
<li><img src="latex/latex2png-Integration_31802196_-5.gif" alt="$\forall f\in F,c\in C(F)$" class="latex-inline" style="vertical-align: -5px" width="123" height="18">，<img src="latex/latex2png-Integration_221609693_-5.gif" alt="$D(cf)=cD(f)$" class="latex-inline" style="vertical-align: -5px" width="109" height="18">。</li>
<li>（除法）<img src="latex/latex2png-Integration_37741971_-4.gif" alt="$\forall f,g\in F,g\ne 0$" class="latex-inline" style="vertical-align: -4px" width="112" height="16">，<img src="latex/latex2png-Integration_106386634_.gif" alt="$$D\left(\frac{f}{g}\right)=\frac{gD(f)-fD(g)}{g^2}.$$" class="latex-display" width="580" height="40"></li>
<li><img src="latex/latex2png-Integration_57969606_-5.gif" alt="$C(F)$" class="latex-inline" style="vertical-align: -5px" width="39" height="18">为<img src="latex/latex2png-Integration_42497042_0.gif" alt="$F$" class="latex-inline" style="vertical-align: 0px" width="10" height="8">的子域。</li>
<li><img src="latex/latex2png-Integration_145936823_-4.gif" alt="$\forall f\in F^*, n\in \mathbb{Z}$" class="latex-inline" style="vertical-align: -4px" width="109" height="16">，<img src="latex/latex2png-Integration_150524593_-5.gif" alt="$D(f^n)=nf^{n-1}D(f)$" class="latex-inline" style="vertical-align: -5px" width="150" height="19">。</li>
<li>（对数导数恒等式）<img src="latex/latex2png-Integration_54401265_-4.gif" alt="$\forall f_1,\ldots,f_n\in F^*, e_1,\ldots,e_n\in \mathbb{Z}$" class="latex-inline" style="vertical-align: -4px" width="227" height="16">，<img src="latex/latex2png-Integration_231281063_.gif" alt="$$\frac{D(f_1^{e_1}\cdots f_n^{e_n})}{f_1^{e_1}\cdots f_n^{e_n}}=e_1\frac{D(f_1)}{f_1}+\cdots+e_1\frac{D(f_n)}{f_n}.$$" class="latex-display" width="580" height="40"></li>
<li>（复合求导）设多项式<img src="latex/latex2png-Integration_56967323_-5.gif" alt="$P\in C(F)[x_1,\ldots,x_n]$" class="latex-inline" style="vertical-align: -5px" width="152" height="18">，<img src="latex/latex2png-Integration_45295531_-4.gif" alt="$f_1,\ldots,f_n\in F$" class="latex-inline" style="vertical-align: -4px" width="101" height="16">，则有<img src="latex/latex2png-Integration_54584824_.gif" alt="$$D(P(f_1,\ldots,f_n))=\sum_{i=1}^{n}\frac{\partial P}{\partial x_i}(f_1,\ldots,f_n)D(f_i).$$" class="latex-display" width="580" height="45"></li>
</ol>


</div>

<p>微分代数的基本性质使得我们可以完全脱离分析语言，将符号积分的问题视为纯代数问题。而我们关心的“初等函数”，也可以直接用代数语言来描述。</p>

<div class="definition">
<span class="theorem-header">定义2<a name=""></a></span><span class="theorem-name">(初等函数)</span>
设<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">为一个微分代数，<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">的微分扩张，满足<img src="latex/latex2png-Integration_58785220_-5.gif" alt="$C(K(\theta))=C(K)$" class="latex-inline" style="vertical-align: -5px" width="123" height="18">，微分算子<img src="latex/latex2png-Integration_42365970_0.gif" alt="$D$" class="latex-inline" style="vertical-align: 0px" width="13" height="12">简记为'。<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">称为在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的初等生成元，若<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">满足以下条件之一：

<ol>
<li><img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上是代数的，即有<img src="latex/latex2png-Integration_40994369_-5.gif" alt="$f(x)\in K[x]$" class="latex-inline" style="vertical-align: -5px" width="84" height="18">使得<img src="latex/latex2png-Integration_35424204_-5.gif" alt="$f(\theta)=0$" class="latex-inline" style="vertical-align: -5px" width="60" height="18">；</li>
<li><img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上是指数的，即有<img src="latex/latex2png-Integration_85093374_-4.gif" alt="$\eta\in K$" class="latex-inline" style="vertical-align: -4px" width="44" height="16">使得<img src="latex/latex2png-Integration_145896323_-11.gif" alt="$\dfrac{\theta'}{\theta}=\eta'$" class="latex-inline" style="vertical-align: -11px" width="50" height="35">（记<img src="latex/latex2png-Integration_11163399_-4.gif" alt="$\theta=\exp \eta$" class="latex-inline" style="vertical-align: -4px" width="67" height="16">）；</li>
<li><img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上是对数的，即有<img src="latex/latex2png-Integration_85093374_-4.gif" alt="$\eta\in K$" class="latex-inline" style="vertical-align: -4px" width="44" height="16">使得<img src="latex/latex2png-Integration_167388459_-15.gif" alt="$\theta'{}=\dfrac{\eta'}{\eta}$" class="latex-inline" style="vertical-align: -15px" width="51" height="39">（记<img src="latex/latex2png-Integration_30481820_-4.gif" alt="$\theta=\ln \eta$" class="latex-inline" style="vertical-align: -4px" width="55" height="16">）。</li>
</ol>

<p>称<img src="latex/latex2png-Integration_30377056_-5.gif" alt="$K(\theta_1,\ldots,\theta_n)$" class="latex-inline" style="vertical-align: -5px" width="96" height="18">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的一个初等函数域，若<img src="latex/latex2png-Integration_159627765_-3.gif" alt="$\forall 1\le i\le n$" class="latex-inline" style="vertical-align: -3px" width="78" height="15">，<img src="latex/latex2png-Integration_10648493_-2.gif" alt="$\theta_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="14">为<img src="latex/latex2png-Integration_154536246_-5.gif" alt="$K(\theta_1,\ldots,\theta_{i-1})$" class="latex-inline" style="vertical-align: -5px" width="109" height="18">上的初等生成元。任<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的一个初等函数域中的元素称为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的初等函数。</p>


</div>

<div class="remark">
<span class="proof-header">注5<a name=""></a></span><span class="theorem-name"></span>
考虑<img src="latex/latex2png-Integration_187818697_-5.gif" alt="$K=\mathbb{Q}(x)$" class="latex-inline" style="vertical-align: -5px" width="70" height="18">、<img src="latex/latex2png-Integration_187651642_-5.gif" alt="$\mathbb{R}(x)$" class="latex-inline" style="vertical-align: -5px" width="32" height="18">或<img src="latex/latex2png-Integration_187651627_-5.gif" alt="$\mathbb{C}(x)$" class="latex-inline" style="vertical-align: -5px" width="32" height="18">时即为通常意义下“初等函数”。


</div>

<div class="remark">
<span class="proof-header">注6<a name=""></a></span><span class="theorem-name"></span>
定义中的<img src="latex/latex2png-Integration_58785220_-5.gif" alt="$C(K(\theta))=C(K)$" class="latex-inline" style="vertical-align: -5px" width="123" height="18">保证了如果<img src="latex/latex2png-Integration_143618060_-1.gif" alt="$\theta'\in K$" class="latex-inline" style="vertical-align: -1px" width="48" height="14">的话，<img src="latex/latex2png-Integration_4451050_0.gif" alt="$\theta'$" class="latex-inline" style="vertical-align: 0px" width="12" height="13">必定不是<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">中元素的导数。


</div>


<p>下面来自Liouville的重要定理，描述了积分为初等函数时必定具有的形式，证明需要对三种特殊扩张情形进行讨论，并最终得出一般情形<span class="cite"><a class="cite" href="Integration.html#ref-4" name="cite-4">[4]</a></span>，<span class="cite"><a class="cite" href="Integration.html#ref-2" name="cite-2">[2]</a></span>。</p>

<div class="theorem">
<span class="theorem-header">定理1<a name=""></a></span><span class="theorem-name">(Liouville)</span>
设<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">为一个微分代数，<img src="latex/latex2png-Integration_129131438_-4.gif" alt="$f\in K$" class="latex-inline" style="vertical-align: -4px" width="44" height="16">，若<img src="latex/latex2png-Integration_239115799_-5.gif" alt="$\int f$" class="latex-inline" style="vertical-align: -5px" width="22" height="19">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的初等函数（即<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">有初等积分），则有<img src="latex/latex2png-Integration_248292364_.gif" alt="$$\int f=v_0+\sum_{i=1}^nc_i\ln v_i,$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_126437774_-3.gif" alt="$v_0\in K$" class="latex-inline" style="vertical-align: -3px" width="51" height="15">，<img src="latex/latex2png-Integration_54157475_-5.gif" alt="$c_i\in \overline{C(K)}$" class="latex-inline" style="vertical-align: -5px" width="75" height="20">（代数闭包），<img src="latex/latex2png-Integration_145919531_-5.gif" alt="$v_i\in \hat K=K(c_1,\ldots,c_n)$" class="latex-inline" style="vertical-align: -5px" width="166" height="21">。


</div>

<div class="remark">
<span class="proof-header">注7<a name=""></a></span><span class="theorem-name"></span>
可以验证在<img src="latex/latex2png-Integration_187818697_-5.gif" alt="$K=\mathbb{Q}(x)$" class="latex-inline" style="vertical-align: -5px" width="70" height="18">、<img src="latex/latex2png-Integration_187651642_-5.gif" alt="$\mathbb{R}(x)$" class="latex-inline" style="vertical-align: -5px" width="32" height="18">或<img src="latex/latex2png-Integration_187651627_-5.gif" alt="$\mathbb{C}(x)$" class="latex-inline" style="vertical-align: -5px" width="32" height="18">时与我们在上一节得到的结果是一致的。


</div>


<h2><a name="sec8" id="sec8"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>超越对数函数积分</h2>

<h3><a name="sec9" id="sec9"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>分解引理</h3>

<p class="first">设<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的一个超越对数函数，我们考虑<img src="latex/latex2png-Integration_133595818_-5.gif" alt="$f\in K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="64" height="18">的积分问题。可设<img src="latex/latex2png-Integration_139290177_-11.gif" alt="$f=p+\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="71" height="30">，其中<img src="latex/latex2png-Integration_55349625_-5.gif" alt="$p,q,r \in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="92" height="18">，<img src="latex/latex2png-Integration_42693650_-4.gif" alt="$q$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">，<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">互素且<img src="latex/latex2png-Integration_228505422_-4.gif" alt="$\deg q<\deg r$" class="latex-inline" style="vertical-align: -4px" width="93" height="16">，下面的引理使得我们能够沿着和有理函数积分类似的道路走下去。</p>

<div class="lemma">
<span class="theorem-header">引理2<a name="le:decomp1"></a></span><span class="theorem-name">(超越对数函数分解引理)</span>
设<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的超越对数函数，若<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分，则<img src="latex/latex2png-Integration_42628114_-4.gif" alt="$p$" class="latex-inline" style="vertical-align: -4px" width="9" height="12">，<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">都在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分。


</div>

<div class="proof">
<span class="proof-header">证明</span>
以<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">代替<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">应用Liouville定理可得<img src="latex/latex2png-Integration_248292364_.gif" alt="$$\int f=v_0+\sum_{i=1}^nc_i\ln v_i,$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_130902154_-5.gif" alt="$v_0\in K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="71" height="18">，<img src="latex/latex2png-Integration_54157475_-5.gif" alt="$c_i\in \overline{C(K)}$" class="latex-inline" style="vertical-align: -5px" width="75" height="20">，记<img src="latex/latex2png-Integration_55835124_-5.gif" alt="$\hat K=K(c_1,\ldots,c_n)$" class="latex-inline" style="vertical-align: -5px" width="132" height="21">，通过拆分对数项可以保证<img src="latex/latex2png-Integration_179958354_-5.gif" alt="$v_i\in \hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="65" height="21">为首一多项式。求导得<img src="latex/latex2png-Integration_63295477_.gif" alt="$$f=v_0'+\sum_{i=1}^nc_i\frac{v_i'}{v_i}.$$" class="latex-display" width="580" height="45">设<img src="latex/latex2png-Integration_181347287_-15.gif" alt="$v_0=p_0+\dfrac{q_0}{r_0}$" class="latex-inline" style="vertical-align: -15px" width="91" height="34">，其中<img src="latex/latex2png-Integration_177891751_-5.gif" alt="$p_0,q_0,r_0\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="113" height="18">。根据<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">为<img src="latex/latex2png-Integration_28467691_0.gif" alt="$\hat K$" class="latex-inline" style="vertical-align: 0px" width="15" height="16">中元素还是<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中正次数多项式将右端第二项拆为两部分，可知
<img src="latex/latex2png-Integration_262502375_.gif" alt="
\begin{align*}
p+\frac{q}{r}&=\left(p_0+\dfrac{q_0}{r_0}\right)'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}+\sum_{i=k+1}^nc_i\frac{v_i'}{v_i} \\
&=\underbrace{\left(p_0'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}\right)}_{\in \hat K[\theta]}+\underbrace{\left(\left(\frac{q_0}{r_0}\right)'+\sum_{i=k+1}^nc_i\frac{v_i'}{v_i}\right)}_{\in \hat K(\theta)\text{为真分式}}.
\end{align*}
" class="latex-display" width="580" height="140">
由于<img src="latex/latex2png-Integration_86513565_-9.gif" alt="$\theta'{}=\frac{\eta'}{\eta}$" class="latex-inline" style="vertical-align: -9px" width="49" height="26">，故<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中的多项式的导数仍为<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中的多项式，又<img src="latex/latex2png-Integration_179110742_-2.gif" alt="$v_i\in \hat K$" class="latex-inline" style="vertical-align: -2px" width="49" height="18">，可知右端的一项为<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中的多项式；又由<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">为<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中首一多项式，可验证<img src="latex/latex2png-Integration_239776663_-14.gif" alt="$\dfrac{v_i'}{v_i}$" class="latex-inline" style="vertical-align: -14px" width="14" height="38">为<img src="latex/latex2png-Integration_32932071_-5.gif" alt="$\hat K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="21">中的真分式。

<p>由于<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上超越，等式两端的关于<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">的多项式和真分式必定对应相等，从而
<img src="latex/latex2png-Integration_116800106_.gif" alt="
\begin{equation*}
  \left\{
    \begin{aligned}
      p&=p_0'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}, \\
      \frac{q}{r}&=\left(\frac{q_0}{r_0}\right)'+\sum_{i=k+1}^nc_i\frac{v_i'}{v_i}.
    \end{aligned}\right.\tag{4}
\end{equation*}
" class="latex-display" name="eqref-4" width="580" height="111">
故<img src="latex/latex2png-Integration_42628114_-4.gif" alt="$p$" class="latex-inline" style="vertical-align: -4px" width="9" height="12">，<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">都在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分。
<span class="proof-end">□</span></p>

</div>


<h3><a name="sec10" id="sec10"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>多项式部分</h3>

<p class="first">由分解引理，我们可以等价地分别对多项式部分<img src="latex/latex2png-Integration_42628114_-4.gif" alt="$p$" class="latex-inline" style="vertical-align: -4px" width="9" height="12">和有理部分<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">分别求积分，如果其中有一个无初等积分，则<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">也必无初等积分。</p>

<div class="remark">
<span class="proof-header">注8<a name=""></a></span><span class="theorem-name"></span>
一般来说将被积函数<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">拆成两项分别积分与直接积分并不等价。例如<img src="latex/latex2png-Integration_59827726_.gif" alt="$$\int x^x,\quad \int x^x\ln x$$" class="latex-display" width="580" height="37">均非初等函数，但<img src="latex/latex2png-Integration_18181332_.gif" alt="$$\int x^x(1+\ln x)=x^x.$$" class="latex-display" width="580" height="37">


</div>

<div class="remark">
<span class="proof-header">注9<a name=""></a></span><span class="theorem-name"></span>
在下面的算法过程中，为了求得<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">中函数的积分，我们预先需要知道如何对基域<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">中的函数作积分。例如我们已经知道有理函数域<img src="latex/latex2png-Integration_187818683_-5.gif" alt="$K=\mathbb{C}(x)$" class="latex-inline" style="vertical-align: -5px" width="69" height="18">上的积分方法，因此便可以解决例如<img src="latex/latex2png-Integration_29971972_-5.gif" alt="$\mathbb{C}(x,\ln x)$" class="latex-inline" style="vertical-align: -5px" width="66" height="18">中的积分问题。再取<img src="latex/latex2png-Integration_29971972_-5.gif" alt="$\mathbb{C}(x,\ln x)$" class="latex-inline" style="vertical-align: -5px" width="66" height="18">作为新的基域<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">，便能得到<img src="latex/latex2png-Integration_20845896_-5.gif" alt="$\mathbb{C}(x,\ln x, \ln\ln x)$" class="latex-inline" style="vertical-align: -5px" width="116" height="18">中函数的积分方法。如此可以递归的地做下去，构成了一种“塔状”的求积分过程，我们在后面可以看到，类似这样的过程将最终可以在理论上解决任意复杂形式初等函数积分问题。


</div>


<p>在式<a class="ref-eq" href="Integration.html#eqref-4"  title="公式(4)">(4)</a>中设<img src="latex/latex2png-Integration_66803176_.gif" alt="$$p=\sum_{i=0}^mA_i\theta^i,\quad p_0=\sum_{i=0}^nB_i\theta^i,$$" class="latex-display" width="580" height="46">其中<img src="latex/latex2png-Integration_9819018_-4.gif" alt="$A_i, B_i\in  K$" class="latex-inline" style="vertical-align: -4px" width="79" height="16">，则有<img src="latex/latex2png-Integration_204512793_.gif" alt="$$\sum_{i=1}^mA_i\theta^i=\sum_{i=0}^nB_i'\theta^i+\sum_{i=1}^niB_i\theta^{i-1}\theta'+\sum_{i=1}^k\frac{c_iv_i'}{v_i}.$$" class="latex-display" width="580" height="49"> 由于<img src="latex/latex2png-Integration_120812564_-2.gif" alt="$A_i$" class="latex-inline" style="vertical-align: -2px" width="17" height="14">已知，我们的目标是求出<img src="latex/latex2png-Integration_137589780_-2.gif" alt="$B_i$" class="latex-inline" style="vertical-align: -2px" width="18" height="14">和<img src="latex/latex2png-Integration_211204214_-15.gif" alt="$\sum_{i=1}^k\limits c_i\ln v_i$" class="latex-inline" style="vertical-align: -15px" width="69" height="39">。利用<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上超越，可得
<img src="latex/latex2png-Integration_70532327_.gif" alt="
\begin{equation*}
  n=
  \begin{cases}
    m+1 & \text{若}~B_n'=0, \\
    m & \text{若}~B_n'\ne 0.
  \end{cases}
\end{equation*}
" class="latex-display" width="580" height="61">
若<img src="latex/latex2png-Integration_184720533_-4.gif" alt="$B_n'=0$" class="latex-inline" style="vertical-align: -4px" width="52" height="17">，则<img src="latex/latex2png-Integration_26608551_-4.gif" alt="$B_{m+1}$" class="latex-inline" style="vertical-align: -4px" width="41" height="16">为非零常数，否则可约定<img src="latex/latex2png-Integration_193641360_-4.gif" alt="$B_{m+1}=0$" class="latex-inline" style="vertical-align: -4px" width="72" height="16">，于是无论何种情况考虑<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">的最高次项<img src="latex/latex2png-Integration_11434925_0.gif" alt="$\theta^m$" class="latex-inline" style="vertical-align: 0px" width="20" height="12">可得<img src="latex/latex2png-Integration_262480135_.gif" alt="$$A_m=B_m'+(m+1)B_{m+1}\theta',$$" class="latex-display" width="580" height="19">所以<img src="latex/latex2png-Integration_108935919_.gif" alt="$$B_m=-(m+1)B_{m+1}\theta+\int A_m.$$" class="latex-display" width="580" height="37">可知<img src="latex/latex2png-Integration_45546176_-13.gif" alt="$\displaystyle\int A_m$" class="latex-inline" style="vertical-align: -13px" width="42" height="37">为<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中小于一次的多项式，可确定下常数<img src="latex/latex2png-Integration_26608551_-4.gif" alt="$B_{m+1}$" class="latex-inline" style="vertical-align: -4px" width="41" height="16">以及<img src="latex/latex2png-Integration_81112855_-2.gif" alt="$B_m\in  K$" class="latex-inline" style="vertical-align: -2px" width="61" height="14">。当然，由于<img src="latex/latex2png-Integration_45546176_-13.gif" alt="$\displaystyle\int A_m$" class="latex-inline" style="vertical-align: -13px" width="42" height="37">积分常数的存在，<img src="latex/latex2png-Integration_137851924_-2.gif" alt="$B_m$" class="latex-inline" style="vertical-align: -2px" width="25" height="14">的确定是在相差一个常数下而言的，设此积分常数为<img src="latex/latex2png-Integration_3634196_-2.gif" alt="$b_m$" class="latex-inline" style="vertical-align: -2px" width="19" height="14">。接下来再考虑两边<img src="latex/latex2png-Integration_257330317_0.gif" alt="$\theta^{m-1}$" class="latex-inline" style="vertical-align: 0px" width="36" height="14">项可得<img src="latex/latex2png-Integration_42975125_.gif" alt="$$A_{m-1}=B_{m-1}'+m(B_m+b_m)\theta',$$" class="latex-display" width="580" height="19">同样可知<img src="latex/latex2png-Integration_30903119_.gif" alt="$$B_{m-1}=-mb_m\theta+\int A_{m-1}-mB_m\theta',$$" class="latex-display" width="580" height="37">于是<img src="latex/latex2png-Integration_126021534_-13.gif" alt="$\displaystyle\int  A_{m-1}-mB_m\theta'$" class="latex-inline" style="vertical-align: -13px" width="133" height="37">为<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中小于一次的多项式，可确定常数<img src="latex/latex2png-Integration_3634196_-2.gif" alt="$b_m$" class="latex-inline" style="vertical-align: -2px" width="19" height="14">及<img src="latex/latex2png-Integration_13757601_-2.gif" alt="$B_{m-1}+b_{m-1}$" class="latex-inline" style="vertical-align: -2px" width="97" height="14">（<img src="latex/latex2png-Integration_6943833_-2.gif" alt="$b_{m-1}$" class="latex-inline" style="vertical-align: -2px" width="35" height="14">为积分常数）。如此续行，直到比较<img src="latex/latex2png-Integration_12811181_0.gif" alt="$\theta^0$" class="latex-inline" style="vertical-align: 0px" width="14" height="14">项可得<img src="latex/latex2png-Integration_253197783_.gif" alt="$$A_0=B_0'+(B_1+b_1)\theta'+\sum_{i=1}^k\frac{c_iv_i'}{v_i},$$" class="latex-display" width="580" height="48">积分得<img src="latex/latex2png-Integration_263982712_.gif" alt="$$B_0+\sum_{i=1}^kc_i\ln v_i=\int A_0-\int(B_1+b_1)\theta'.$$" class="latex-display" width="580" height="48">最终求出常数<img src="latex/latex2png-Integration_2323476_-2.gif" alt="$b_1$" class="latex-inline" style="vertical-align: -2px" width="13" height="14">，以及<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的对数部分<img src="latex/latex2png-Integration_238992700_-15.gif" alt="$\sum\limits_{i=1}^kc_i\ln v_i$" class="latex-inline" style="vertical-align: -15px" width="69" height="39">（注意这最后一步右端积分未必落在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">中），从而我们（在相差一个常数的意义下）求出了多项式部分的积分。</p>


<h3><a name="sec11" id="sec11"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>有理部分与对数部分</h3>

<p class="first">我们希望求出<a class="ref-eq" href="Integration.html#eqref-4"  title="公式(4)">(4)</a>中的<img src="latex/latex2png-Integration_218064409_-15.gif" alt="$\dfrac{q_0}{r_0}$" class="latex-inline" style="vertical-align: -15px" width="15" height="34">和<img src="latex/latex2png-Integration_165643752_-17.gif" alt="$\sum\limits_{i=k+1}^nc_i\ln v_i$" class="latex-inline" style="vertical-align: -17px" width="87" height="38">，求积分的有理部分和对数部分可以和有理函数积分类似的做。为确保类似Hermite约化的过程能够进行，我们验证如下的引理。</p>

<div class="lemma">
<span class="theorem-header">引理3<a name="le:coprime1"></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_129978858_-5.gif" alt="$r\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="59" height="18">为正次数的无平方因子的多项式，则<img src="latex/latex2png-Integration_47562466_-5.gif" alt="$(r,r')=1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">。


</div>

<div class="proof">
<span class="proof-header">证明</span>
设<img src="latex/latex2png-Integration_83403256_-15.gif" alt="$r=\prod\limits_{i=1}^n(\theta-a_i)$" class="latex-inline" style="vertical-align: -15px" width="106" height="36">为<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">在<img src="latex/latex2png-Integration_198615914_0.gif" alt="$\overline{K}$" class="latex-inline" style="vertical-align: 0px" width="16" height="14">上的分解。则由复合函数求导
<img src="latex/latex2png-Integration_185849632_.gif" alt="
\begin{align*}
  r'&=\sum_{i=1}^n\prod_{j\ne i}(\theta-a_i)(\theta-a_i)' \\
  &=\sum_{i=1}^n\prod_{j\ne i}(\theta-a_i)(\frac{\eta'}{\eta}-a_i').
\end{align*}
" class="latex-display" width="580" height="107">
若<img src="latex/latex2png-Integration_254771023_-5.gif" alt="$(r,r')\ne1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">，则存在<img src="latex/latex2png-Integration_42169362_0.gif" alt="$i$" class="latex-inline" style="vertical-align: 0px" width="5" height="12">，使得<img src="latex/latex2png-Integration_24454898_-15.gif" alt="$\theta-a_i\mid \dfrac{\eta'}{\eta}-a_i'$" class="latex-inline" style="vertical-align: -15px" width="108" height="39">。由于<img src="latex/latex2png-Integration_19038301_-15.gif" alt="$\dfrac{\eta'}{\eta}-a_i'\in \overline{K}$" class="latex-inline" style="vertical-align: -15px" width="86" height="39">，而<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上超越，必有<img src="latex/latex2png-Integration_217420429_-15.gif" alt="$\dfrac{\eta'}{\eta}=a_i'$" class="latex-inline" style="vertical-align: -15px" width="52" height="39">。则<img src="latex/latex2png-Integration_70218059_-2.gif" alt="$\theta=a_i+c$" class="latex-inline" style="vertical-align: -2px" width="72" height="14">（<img src="latex/latex2png-Integration_41776146_0.gif" alt="$c$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">为常数）为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的代数元，矛盾！
<span class="proof-end">□</span>

</div>


<p>有了引理<a class="ref-th" href="Integration.html#le:coprime1">3</a>中<img src="latex/latex2png-Integration_47562466_-5.gif" alt="$(r,r')=1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">的保证，我们就可以施行Hermite约化过程了。将<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">在<img src="latex/latex2png-Integration_41977110_-5.gif" alt="$K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="18">上作无平方分解<img src="latex/latex2png-Integration_45373067_-15.gif" alt="$r=\prod\limits_{i=1}^nr_i^i$" class="latex-inline" style="vertical-align: -15px" width="67" height="36">，完全类似可以得到式<a class="ref-eq" href="Integration.html#eqref-2"  title="公式(2)">(2)</a>的约化结果，从而求出积分的有理部分<img src="latex/latex2png-Integration_218064409_-15.gif" alt="$\dfrac{q_0}{r_0}$" class="latex-inline" style="vertical-align: -15px" width="15" height="34">。</p>

<p>同样有求对数部分的Rothstein-Trager方法的类似版本。设<img src="latex/latex2png-Integration_129978858_-5.gif" alt="$r\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="59" height="18">无平方因子，则积分的形式必为<img src="latex/latex2png-Integration_29041983_-17.gif" alt="$\dfrac{q}{r}=\sum\limits_{i=k+1}^nc_i\ln v_i$" class="latex-inline" style="vertical-align: -17px" width="119" height="38">，其中<img src="latex/latex2png-Integration_54157475_-5.gif" alt="$c_i\in \overline{C(K)}$" class="latex-inline" style="vertical-align: -5px" width="75" height="20">为常数，<img src="latex/latex2png-Integration_179958354_-5.gif" alt="$v_i\in \hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="65" height="21">。求得Rothstein-Trager结式<img src="latex/latex2png-Integration_245991324_-5.gif" alt="$\res_\theta(q-yr',r)$" class="latex-inline" style="vertical-align: -5px" width="110" height="18">关于<img src="latex/latex2png-Integration_43217938_-4.gif" alt="$y$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">的根<img src="latex/latex2png-Integration_249662922_-5.gif" alt="$c_i\in \overline{K(\theta)}$" class="latex-inline" style="vertical-align: -5px" width="70" height="20">，若有<img src="latex/latex2png-Integration_20149268_-2.gif" alt="$c_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">不是常数，则<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">在<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">上必无初等积分；若<img src="latex/latex2png-Integration_20149268_-2.gif" alt="$c_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">均为常数，计算最大公因子<img src="latex/latex2png-Integration_227313521_-5.gif" alt="$(q-c_ir',r)$" class="latex-inline" style="vertical-align: -5px" width="79" height="18">即可得到<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">。</p>

<div class="problem">
<span class="proof-header">例3<a name=""></a></span><span class="theorem-name"></span>
计算<img src="latex/latex2png-Integration_152849169_-13.gif" alt="$\displaystyle\int\dfrac{1}{x\ln x}$" class="latex-inline" style="vertical-align: -13px" width="59" height="37">。

<p>令<img src="latex/latex2png-Integration_124489364_0.gif" alt="$\theta=\ln x$" class="latex-inline" style="vertical-align: 0px" width="56" height="12">，为<img src="latex/latex2png-Integration_187818697_-5.gif" alt="$K=\mathbb{Q}(x)$" class="latex-inline" style="vertical-align: -5px" width="70" height="18">上的超越对数函数，被积函数为<img src="latex/latex2png-Integration_77359265_-11.gif" alt="$\dfrac{q}{r}=\dfrac{1}{x\cdot\theta}\in K(\theta)$" class="latex-inline" style="vertical-align: -11px" width="121" height="33">。<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">无平方因子，可以直接施行Rothstein-Trager方法。<img src="latex/latex2png-Integration_74876640_-2.gif" alt="$r'{}=\theta+1$" class="latex-inline" style="vertical-align: -2px" width="70" height="15">，故
<img src="latex/latex2png-Integration_202738542_.gif" alt="
\begin{align*}
  \res_\theta(q-yr',r)&=\res_\theta(1-y(\theta+1),x\theta) \\
  &=
  \begin{vmatrix}
    -y & x \\
    1-y & 0
  \end{vmatrix} \\
  &=-(1-y)x.
\end{align*}
" class="latex-display" width="580" height="110">
可知此结式关于<img src="latex/latex2png-Integration_43217938_-4.gif" alt="$y$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">只有一个根<img src="latex/latex2png-Integration_16550892_0.gif" alt="$c=1$" class="latex-inline" style="vertical-align: 0px" width="36" height="11">，且为常数。计算最大公因子
<img src="latex/latex2png-Integration_75330647_.gif" alt="
\begin{align*}
v=(q-cr',r)&=(1-(\theta+1),x\theta ) \\
&=(\theta,x\theta) \\
&=\theta.
\end{align*}
" class="latex-display" width="580" height="75">
最终可知<img src="latex/latex2png-Integration_158776070_.gif" alt="$$\int \frac{1}{x\ln x}=c\ln v=\ln \theta=\ln \ln x$$" class="latex-display" width="580" height="37">即为积分结果。
<span class="example-end">◇</span></p>

</div>

<div class="problem">
<span class="proof-header">例4<a name=""></a></span><span class="theorem-name"></span>
计算<img src="latex/latex2png-Integration_59754297_-13.gif" alt="$\displaystyle\int\dfrac{1}{\ln x}$" class="latex-inline" style="vertical-align: -13px" width="47" height="37">。

<p>令<img src="latex/latex2png-Integration_124489364_0.gif" alt="$\theta=\ln x$" class="latex-inline" style="vertical-align: 0px" width="56" height="12">，为<img src="latex/latex2png-Integration_187818697_-5.gif" alt="$K=\mathbb{Q}(x)$" class="latex-inline" style="vertical-align: -5px" width="70" height="18">上的超越对数函数，被积函数为<img src="latex/latex2png-Integration_10365562_-11.gif" alt="$\dfrac{q}{r}=\dfrac{1}{\theta}\in K(\theta)$" class="latex-inline" style="vertical-align: -11px" width="100" height="33">。<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">无平方因子，可以直接施行Rothstein-Trager方法。<img src="latex/latex2png-Integration_185732363_-11.gif" alt="$r'{}=\dfrac{1}{x}$" class="latex-inline" style="vertical-align: -11px" width="47" height="33">，故<img src="latex/latex2png-Integration_216791399_-11.gif" alt="$\res_\theta(q-yr',r)=\res_\theta(1-y\cdot\dfrac{1}{x},\theta)=1-\dfrac{y}{x}$" class="latex-inline" style="vertical-align: -11px" width="321" height="33">，结式关于<img src="latex/latex2png-Integration_43217938_-4.gif" alt="$y$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">的根为<img src="latex/latex2png-Integration_14519276_0.gif" alt="$c=x$" class="latex-inline" style="vertical-align: 0px" width="38" height="8">不为常数，可知<img src="latex/latex2png-Integration_169337528_-11.gif" alt="$\dfrac{1}{\ln x}$" class="latex-inline" style="vertical-align: -11px" width="27" height="33">不是初等可积的。
<span class="example-end">◇</span></p>

</div>




<h2><a name="sec12" id="sec12"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>超越指数函数积分</h2>

<p class="first">我们沿着有理函数积分的道路顺利地解决了超越对数函数积分的问题，接下来自然要考虑的是超越指数函数积分了，即<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的超越指数函数，<img src="latex/latex2png-Integration_133595818_-5.gif" alt="$f\in K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="64" height="18">的积分问题。</p>

<p>但这个问题变得要复杂一些，一方面在计算过程中我们需要在基域<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">中求解微分方程（被称为Risch微分方程<span class="cite"><a class="cite" href="Integration.html#ref-5" name="cite-5">[5]</a></span>）<img src="latex/latex2png-Integration_235026938_.gif" alt="$$y'+f\cdot y=g,$$" class="latex-display" width="580" height="18">其中<img src="latex/latex2png-Integration_126516126_-4.gif" alt="$f,g\in K$" class="latex-inline" style="vertical-align: -4px" width="59" height="16">，<img src="latex/latex2png-Integration_129131134_-4.gif" alt="$y\in K$" class="latex-inline" style="vertical-align: -4px" width="44" height="16">为未知函数。我们将在<a href="DifferentialEquation.html">微分方程符号解</a>中专门讨论Risch微分方程，而且将看到Risch微分方程和符号积分在某种意义下的相互“纠缠”。现在我们暂时假设已经能够在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上完成这样的求解。</p>

<p>复杂性的另一面在于，<img src="latex/latex2png-Integration_129978858_-5.gif" alt="$r\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="59" height="18">无平方因子也不能保证<img src="latex/latex2png-Integration_47562466_-5.gif" alt="$(r,r')=1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">。</p>

<div class="problem">
<span class="proof-header">例5<a name=""></a></span><span class="theorem-name"></span>
考虑<img src="latex/latex2png-Integration_45959665_0.gif" alt="$\theta=e^x$" class="latex-inline" style="vertical-align: 0px" width="45" height="12">，<img src="latex/latex2png-Integration_35936034_0.gif" alt="$r=\theta$" class="latex-inline" style="vertical-align: 0px" width="38" height="12">，<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">无平方因子，但<img src="latex/latex2png-Integration_244200202_-5.gif" alt="$(r,r')=(\theta,\theta)=\theta\ne1$" class="latex-inline" style="vertical-align: -5px" width="157" height="18">。
<span class="example-end">◇</span>

</div>

<p>因此我们需要对引理<a class="ref-th" href="Integration.html#le:coprime1">3</a>做一个小的修订。</p>

<div class="lemma">
<span class="theorem-header">引理4<a name="le:coprime2"></a></span><span class="theorem-name"></span>
设<img src="latex/latex2png-Integration_129978858_-5.gif" alt="$r\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="59" height="18">为正次数的无平方因子的多项式，且<img src="latex/latex2png-Integration_227776676_-5.gif" alt="$\theta\nmid r$" class="latex-inline" style="vertical-align: -5px" width="29" height="18">，则<img src="latex/latex2png-Integration_47562466_-5.gif" alt="$(r,r')=1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">。


</div>

<div class="proof">
<span class="proof-header">证明</span>

<p>设<img src="latex/latex2png-Integration_83403256_-15.gif" alt="$r=\prod\limits_{i=1}^n(\theta-a_i)$" class="latex-inline" style="vertical-align: -15px" width="106" height="36">为<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">在<img src="latex/latex2png-Integration_198615914_0.gif" alt="$\overline{K}$" class="latex-inline" style="vertical-align: 0px" width="16" height="14">上的分解。则由复合函数求导
<img src="latex/latex2png-Integration_10635565_.gif" alt="
\begin{align*}
  r'&=\sum_{i=1}^n\prod_{j\ne i}(\theta-a_i)(\theta-a_i)' \\
  &=\sum_{i=1}^n\prod_{j\ne i}(\theta-a_i)(\eta'\theta-a_i').
\end{align*}
" class="latex-display" width="580" height="107">
若<img src="latex/latex2png-Integration_254771023_-5.gif" alt="$(r,r')\ne1$" class="latex-inline" style="vertical-align: -5px" width="68" height="18">，则存在<img src="latex/latex2png-Integration_42169362_0.gif" alt="$i$" class="latex-inline" style="vertical-align: 0px" width="5" height="12">，使得<img src="latex/latex2png-Integration_119068093_-5.gif" alt="$\theta-a_i\mid \eta'\theta-a_i'$" class="latex-inline" style="vertical-align: -5px" width="113" height="18">，从而<img src="latex/latex2png-Integration_218863101_-4.gif" alt="$\eta'a_i=a_i'$" class="latex-inline" style="vertical-align: -4px" width="64" height="17">。由于<img src="latex/latex2png-Integration_227776676_-5.gif" alt="$\theta\nmid r$" class="latex-inline" style="vertical-align: -5px" width="29" height="18">，故<img src="latex/latex2png-Integration_168096585_-4.gif" alt="$a_i\ne0$" class="latex-inline" style="vertical-align: -4px" width="44" height="16">。而<img src="latex/latex2png-Integration_254521846_.gif" alt="$$\left(\frac{a_i}{\theta}\right)'{}=\frac{a_i'\theta-\theta'a_i}{\theta^2}=\frac{a_i'-\eta'a_i}{\theta}=0,$$" class="latex-display" width="580" height="36">可知<img src="latex/latex2png-Integration_19957028_-2.gif" alt="$a_i=c\theta$" class="latex-inline" style="vertical-align: -2px" width="51" height="14">（<img src="latex/latex2png-Integration_41776146_0.gif" alt="$c$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">为非零常数），这与<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上超越矛盾！
<span class="proof-end">□</span></p>

</div>


<h3><a name="sec13" id="sec13"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>分解引理</h3>

<p class="first">根据引理<a class="ref-th" href="Integration.html#le:coprime2">4</a>，为了能够继续使用Hermite约化，我们需要将分母中的<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">因子分离出来，这就引导我们引入如下定义。</p>

<div class="definition">
<span class="theorem-header">定义3<a name=""></a></span><span class="theorem-name">(广义多项式)</span>
<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">中形如<img src="latex/latex2png-Integration_30222823_-15.gif" alt="$\sum\limits_{i=-m}^nA_i\theta^i$" class="latex-inline" style="vertical-align: -15px" width="71" height="36">的元素称为<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">中的广义多项式。


</div>

<p>在这样的定义下，<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">有广义分解<img src="latex/latex2png-Integration_136670529_-11.gif" alt="$p+\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="41" height="30">，其中<img src="latex/latex2png-Integration_42628114_-4.gif" alt="$p$" class="latex-inline" style="vertical-align: -4px" width="9" height="12">为广义多项式，<img src="latex/latex2png-Integration_127318506_-5.gif" alt="$q,r\in K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="75" height="18">，<img src="latex/latex2png-Integration_42693650_-4.gif" alt="$q$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">，<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">互素，<img src="latex/latex2png-Integration_228505422_-4.gif" alt="$\deg q<\deg r$" class="latex-inline" style="vertical-align: -4px" width="93" height="16">且有<img src="latex/latex2png-Integration_227776676_-5.gif" alt="$\theta\nmid r$" class="latex-inline" style="vertical-align: -5px" width="29" height="18">。有类似于引理<a class="ref-th" href="Integration.html#le:decomp1">2</a>的分解引理，证明过程也是类似的。</p>

<div class="lemma">
<span class="theorem-header">引理5<a name=""></a></span><span class="theorem-name">(超越指数函数分解引理)</span>
设<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">为<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的超越指数函数，若<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分，则<img src="latex/latex2png-Integration_42628114_-4.gif" alt="$p$" class="latex-inline" style="vertical-align: -4px" width="9" height="12">与<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">都在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分。


</div>

<div class="proof">
<span class="proof-header">证明</span>
以<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">代替<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">应用Liouville定理可得<img src="latex/latex2png-Integration_248292364_.gif" alt="$$\int f=v_0+\sum_{i=1}^nc_i\ln v_i,$$" class="latex-display" width="580" height="45">其中<img src="latex/latex2png-Integration_130902154_-5.gif" alt="$v_0\in K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="71" height="18">，<img src="latex/latex2png-Integration_54157475_-5.gif" alt="$c_i\in \overline{C(K)}$" class="latex-inline" style="vertical-align: -5px" width="75" height="20">，记<img src="latex/latex2png-Integration_55835124_-5.gif" alt="$\hat K=K(c_1,\ldots,c_n)$" class="latex-inline" style="vertical-align: -5px" width="132" height="21">，通过拆分对数项可以保证<img src="latex/latex2png-Integration_179958354_-5.gif" alt="$v_i\in \hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="65" height="21">为首一多项式。求导得<img src="latex/latex2png-Integration_63295477_.gif" alt="$$f=v_0'+\sum_{i=1}^nc_i\frac{v_i'}{v_i}.$$" class="latex-display" width="580" height="45">设<img src="latex/latex2png-Integration_181347287_-15.gif" alt="$v_0=p_0+\dfrac{q_0}{r_0}$" class="latex-inline" style="vertical-align: -15px" width="91" height="34">为广义分解，根据<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">为<img src="latex/latex2png-Integration_28467691_0.gif" alt="$\hat K$" class="latex-inline" style="vertical-align: 0px" width="15" height="16">中元素还是<img src="latex/latex2png-Integration_29315303_-5.gif" alt="$\hat K[\theta]$" class="latex-inline" style="vertical-align: -5px" width="31" height="21">中正次数多项式将右端第二项拆为两部分。我们要注意多项式求导的特殊性，由于<img src="latex/latex2png-Integration_18695935_.gif" alt="$$(A_i\theta^i)'{}=A_i'\theta^i+A_ii\theta^{i-1}\theta'{}=(A_i'+A_ii\eta')\theta^i,$$" class="latex-display" width="580" height="20">因此多项式求导后每项的次数都不变，故可假定<img src="latex/latex2png-Integration_198787484_-5.gif" alt="$\theta\nmid v_i$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">。由于<img src="latex/latex2png-Integration_239776663_-14.gif" alt="$\dfrac{v_i'}{v_i}$" class="latex-inline" style="vertical-align: -14px" width="14" height="38">不再是真分式，因此还需将<img src="latex/latex2png-Integration_54096955_-4.gif" alt="$v_i'$" class="latex-inline" style="vertical-align: -4px" width="13" height="17">中的最高次项分离出来（例如减去<img src="latex/latex2png-Integration_261458416_-4.gif" alt="$n_i\eta'v_i$" class="latex-inline" style="vertical-align: -4px" width="42" height="17">），设<img src="latex/latex2png-Integration_62601103_-4.gif" alt="$\deg v_i=n_i$" class="latex-inline" style="vertical-align: -4px" width="79" height="16">，则可得
<img src="latex/latex2png-Integration_177178869_.gif" alt="
\begin{align*}
p+\frac{q}{r}&=\left(p_0+\dfrac{q_0}{r_0}\right)'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}+\sum_{i=k+1}^nc_i\frac{v_i'}{v_i} \\
&=\underbrace{\left(p_0'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}+\sum_{i=k+1}^nc_in_i\eta'\right)}_{\in \hat K(\theta)\text{为广义多项式}}+\underbrace{\left(\left(\frac{q_0}{r_0}\right)'+\sum_{i=k+1}^nc_i\frac{v_i'-n_i\eta'v_i}{v_i}\right)}_{\in \hat K(\theta)\text{为真分式},\ \theta\nmid v_i}
\end{align*}
" class="latex-display" width="580" height="140">

<p>由于<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上超越，等式两端的关于<img src="latex/latex2png-Integration_33267234_0.gif" alt="$\theta$" class="latex-inline" style="vertical-align: 0px" width="8" height="12">的广义多项式和真分式必定对应相等，从而
<img src="latex/latex2png-Integration_156179131_.gif" alt="
\begin{equation*}
  \left\{
    \begin{aligned}
      p&=p_0'+\sum_{i=1}^kc_i\frac{v_i'}{v_i}+\sum_{i=k+1}^nc_in_i\eta', \\
      \frac{q}{r}&=\left(\frac{q_0}{r_0}\right)'+\sum_{i=k+1}^nc_i\frac{v_i'-n_i\eta'v_i}{v_i}.
    \end{aligned}\right.
\end{equation*}
" class="latex-display" width="580" height="111">
故
<img src="latex/latex2png-Integration_164531050_.gif" alt="
\begin{equation*}
  \left\{
\begin{aligned}
\int p&=p_0+\sum_{i=1}^kc_i\ln v_i+\sum_{i=k+1}^nc_in_i\eta, \\
\int\dfrac{q}{r}&=\frac{q_0}{r_0}+\sum_{i=k+1}^nc_i(\ln v_i-n_i\eta),
\end{aligned}\right.\tag{5}
\end{equation*}
" class="latex-display" name="eqref-5" width="580" height="111">
都在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上有初等积分。
<span class="proof-end">□</span></p>

</div>


<h3><a name="sec14" id="sec14"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>多项式部分</h3>

<p class="first">在式<a class="ref-eq" href="Integration.html#eqref-5"  title="公式(5)">(5)</a>中设<img src="latex/latex2png-Integration_222139651_.gif" alt="$$p=\sum_{i=-m}^nA_i\theta^i,\quad p_0=\sum_{i=-m'}^{n'}B_i\theta^i,$$" class="latex-display" width="580" height="51">其中<img src="latex/latex2png-Integration_9819018_-4.gif" alt="$A_i, B_i\in  K$" class="latex-inline" style="vertical-align: -4px" width="79" height="16">，则有<img src="latex/latex2png-Integration_194365370_.gif" alt="$$\sum_{i=-m}^nA_i\theta^i=\left(\sum_{i=-m'}^{n'}B_i\theta^i\right)'+\sum_{i=1}^k\frac{c_iv_i'}{v_i}+\sum_{k+1}^nc_in_i\eta'.$$" class="latex-display" width="580" height="63">由于<img src="latex/latex2png-Integration_120812564_-2.gif" alt="$A_i$" class="latex-inline" style="vertical-align: -2px" width="17" height="14">已知，我们的目标是求出<img src="latex/latex2png-Integration_137589780_-2.gif" alt="$B_i$" class="latex-inline" style="vertical-align: -2px" width="18" height="14">和<img src="latex/latex2png-Integration_232448271_-17.gif" alt="$\sum\limits_{i=1}^kc_i\ln v_i+\sum\limits_{i=k+1}^nc_in_i\eta$" class="latex-inline" style="vertical-align: -17px" width="168" height="41">。由于多项式求导不改变次数，故必有<img src="latex/latex2png-Integration_25785402_0.gif" alt="$n=n'$" class="latex-inline" style="vertical-align: 0px" width="46" height="13">，<img src="latex/latex2png-Integration_243698630_0.gif" alt="$m=m'$" class="latex-inline" style="vertical-align: 0px" width="56" height="13">。比较对应项系数得到
<img src="latex/latex2png-Integration_46289187_.gif" alt="
\begin{equation*}
A_i=B_i'+iB_i\eta',\quad i=-m,\ldots,n,\ i\ne0.\tag{6}
\end{equation*}
" class="latex-display" name="eqref-6" width="580" height="19">
这些是<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上的关于未知量<img src="latex/latex2png-Integration_137589780_-2.gif" alt="$B_i$" class="latex-inline" style="vertical-align: -2px" width="18" height="14">的Risch方程，我们假定了能够在<img src="latex/latex2png-Integration_42824722_0.gif" alt="$K$" class="latex-inline" style="vertical-align: 0px" width="15" height="12">上求解此类方程或给出无解的结论。若其中有一个方程无解，则<img src="latex/latex2png-Integration_41972754_-4.gif" alt="$f$" class="latex-inline" style="vertical-align: -4px" width="8" height="16">在<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">上无初等积分；否则可求出<img src="latex/latex2png-Integration_62126660_-5.gif" alt="$B_i\ (i=-m,\ldots,n,\ i\ne0)$" class="latex-inline" style="vertical-align: -5px" width="186" height="18">，最后根据<img src="latex/latex2png-Integration_44169920_-13.gif" alt="$\displaystyle\int A_0$" class="latex-inline" style="vertical-align: -13px" width="36" height="37">求出<img src="latex/latex2png-Integration_189972639_-17.gif" alt="$B_0+\sum\limits_{i=1}^kc_i\ln v_i+\sum\limits_{i=k+1}^nc_in_i\eta$" class="latex-inline" style="vertical-align: -17px" width="209" height="41">。</p>


<h3><a name="sec15" id="sec15"></a>
<a href="Integration.html#top" class="toplink"><img src="../images/top.gif" border="0" alt="回到顶部" width="40" height="15"></a>有理部分和对数部分</h3>

<p class="first">由于我们有了引理<a class="ref-th" href="Integration.html#le:coprime2">4</a>的保证，依然可以对广义分解中的<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">进行Hermite约化过程，从而得到积分的有理部分。</p>

<p>同样可以用类似于Rothstein-Trager的方法计算对数部分，设<img src="latex/latex2png-Integration_42759186_0.gif" alt="$r$" class="latex-inline" style="vertical-align: 0px" width="7" height="8">无平方因子，则<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">积分的形式为<img src="latex/latex2png-Integration_96020732_-17.gif" alt="$\sum\limits_{i=k+1}^nc_i\dfrac{v_i'-n_i\eta'v_i}{v_i}$" class="latex-inline" style="vertical-align: -17px" width="134" height="41">，可知<img src="latex/latex2png-Integration_13929101_-18.gif" alt="$r=\prod\limits_{j=k+1}^nv_j$" class="latex-inline" style="vertical-align: -18px" width="87" height="39">。记<img src="latex/latex2png-Integration_7489922_-18.gif" alt="$u_i=\prod\limits_{j\ne i}v_j$" class="latex-inline" style="vertical-align: -18px" width="75" height="31">，则<img src="latex/latex2png-Integration_103091648_.gif" alt="$$r'=\sum_{j=k+1}^nu_jv_j',$$" class="latex-display" width="580" height="49">及<img src="latex/latex2png-Integration_181494589_.gif" alt="$$q=\sum_{j=k+1}^nc_j(v_j'-n_j\eta'v_j)u_j.$$" class="latex-display" width="580" height="49">于是
<img src="latex/latex2png-Integration_140392038_.gif" alt="
\begin{align*}
  &\qquad\left(q-c_i\left(r'-r\sum_{j=k+1}^nn_j\eta'\right),r\right) \\
  &=\left(\sum_{j=k+1}^n(c_j-c_i)(v_j'-n_jv_j\eta')u_j,r\right) \\
  &=\prod_{l=k+1}^n\left(\sum_{j=k+1}^n(c_j-c_i)(v_j'-n_jv_j\eta')u_j,v_l\right) \\
  &=v_i.
\end{align*}
" class="latex-display" width="580" height="220">
注意到<img src="latex/latex2png-Integration_201757552_-18.gif" alt="$\sum\limits_{j=k+1}^nn_j=\deg r$" class="latex-inline" style="vertical-align: -18px" width="117" height="39">，知道可以通过求结式<img src="latex/latex2png-Integration_221955443_-5.gif" alt="$\res_\theta(q-y(r'-r\deg r\cdot\eta',r)$" class="latex-inline" style="vertical-align: -5px" width="209" height="18">关于<img src="latex/latex2png-Integration_43217938_-4.gif" alt="$y$" class="latex-inline" style="vertical-align: -4px" width="8" height="12">的根来求得<img src="latex/latex2png-Integration_20214804_-5.gif" alt="$c_j$" class="latex-inline" style="vertical-align: -5px" width="13" height="13">。同样的，如果此结式有根<img src="latex/latex2png-Integration_20149268_-2.gif" alt="$c_i$" class="latex-inline" style="vertical-align: -2px" width="12" height="10">非常数，则<img src="latex/latex2png-Integration_136660154_-11.gif" alt="$\dfrac{q}{r}$" class="latex-inline" style="vertical-align: -11px" width="9" height="30">在<img src="latex/latex2png-Integration_38360342_-5.gif" alt="$K(\theta)$" class="latex-inline" style="vertical-align: -5px" width="35" height="18">上无初等积分；若所有根均为常数，则通过计算最大公因子<img src="latex/latex2png-Integration_3938987_-5.gif" alt="$(q-c_i(r'-r\deg r\cdot\eta'),r)$" class="latex-inline" style="vertical-align: -5px" width="185" height="18">即可求得<img src="latex/latex2png-Integration_197954540_-2.gif" alt="$v_i$" class="latex-inline" style="vertical-align: -2px" width="13" height="10">。</p>




<h4 class="ref">参考文献</h4><p class="ref"><a class="ref" href="Integration.html#cite-1" name="ref-1">[1]</a><span class="ref-author">J. H. Davenport and Y. Siret and E. Tournier, </span><span class="ref-title">Computer algebra: systems and algorithms for algebraic computation, </span><span class="ref-publisher">Academic Press, </span><span class="ref-address">London, UK, </span><span class="ref-year">1988. </span></p>
<p class="ref"><a class="ref" href="Integration.html#cite-2" name="ref-2">[2]</a><span class="ref-author">Manuel Bronstein, </span><span class="ref-title">Symbolic Integration I: Transcendental Functions(2nd ed.), </span><span class="ref-publisher">Springer Verlag, </span><span class="ref-year">2005. </span></p>
<p class="ref"><a class="ref" href="Integration.html#cite-3" name="ref-3">[3]</a><span class="ref-author">Joachim von zur Gathen and J&uuml;rgen Gerhard, </span><span class="ref-title">Modern Computer Algebra, </span><span class="ref-publisher">Cambridge University Press, </span><span class="ref-year">2002. </span></p>
<p class="ref"><a class="ref" href="Integration.html#cite-4" name="ref-4">[4]</a><span class="ref-author">K.O. Geddes and S.R. Czapor and G. Labahn, </span><span class="ref-title">Algorithms for Computer Algebra, </span><span class="ref-publisher">Kluwer Academic Publishers, </span><span class="ref-year">1992. </span></p>
<p class="ref"><a class="ref" href="Integration.html#cite-5" name="ref-5">[5]</a><span class="ref-author">Robert H. Risch, </span><span class="ref-title">The Problem of Integration in Finite Terms, </span><span class="ref-journal">Transactions of the American Mathematical Society </span><span class="ref-volume">139 </span><span class="ref-year">(1969), </span><span class="ref-pages">167-189. </span></p>
<!-- Page published by Emacs Muse ends here -->
      </div><!-- page -->
    </div><!-- left -->
    <div id="bottomshadow"></div><!-- bottom -->
  </div><!-- body -->
  <div id="links">
    <h4>文档列表</h4>
<a href="Arithmetic.html">高精度运算</a>
<a href="PrimeTest.html">素数判定</a>
<a href="IntegerFactorization.html">整数因子分解</a>
<a href="NumberTheory.html">基础数论算法</a>
<a href="Constant.html">数学常数</a>
<a href="ElementaryFunction.html">初等函数</a>
<a href="BasicConceptsNLA.html">数值线性代数基础</a>
<a href="MatrixMultiplication.html">矩阵乘法</a>
<a href="GaussElimination.html">线性方程组与Gauss消元法</a>
<a href="SpecialLinearEquation.html">特殊线形方程组</a>
<a href="QRLS.html">正交化与最小二乘法</a>
<a href="EigenvalueProblem.html">非对称特征值问题</a>
<a href="SymmetricEigenvalueProblem.html">对称特征值问题</a>
<a href="MatrixFunction.html">矩阵函数</a>
<a href="IterationMethods.html">稀疏矩阵中的迭代法</a>
<a href="ExactLinearAlgebra.html">精确线性代数</a>
<a href="PolyEval.html">一元多项式求值和插值</a>
<a href="PolyGCD.html">一元多项式的最大公因子</a>
<a href="PolyFacZp.html">多项式因子分解(有限域)</a>
<a href="PolyFacZ.html">多项式因子分解(Z[x])</a>
<a href="MultiPoly.html">多元多项式最大公因子及因子分解</a>
<a href="FindRoot.html">一元代数方程求解</a>
<a href="EqSolving.html">代数方程组求解</a>
<a href="Summation.html">符号求和</a>
<a href="Integration.html">符号积分</a>
<a href="DifferentialEquation.html">微分方程符号解</a>
  </div><!-- links -->
    <div class="navfoot">
      <hr>
      <table width="100%" border="0" summary="Footer navigation">
	<tr>
	  <td width="33%" align="left">
	    <span class="footdate">最后更新：
			2009年03月18日 16:47:32
		</span>
	  </td>
	  <td width="34%" align="center">
	    <span class="foothome">
	      <a href="../index.html">返回主页</a> / <a href="../RecentChanges.html">更新记录</a> /  <a href="http://cn.creativecommons.org/index.php/licenses/licenses_exp">许可协议</a>
	    </span>
	  </td>
	  <td width="33%" align="right">
	    <span class="footcopy">Copyright &copy; 2007,2008 <a href="../JoinUs.html#contact">maTH&mu; Project Group</a></span>
	  </td>
	</tr>
      </table>
  </div><!-- nav -->
</div><!-- container -->
<p align="center">
<script language="javascript" type="text/javascript" src="http://js.users.51.la/2320853.js"></script></p>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6285506-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>